var h1=[-1.12838,-1.12815,-1.12748,-1.12635,-1.12477,-1.12275,-1.12027,-1.11736,-1.11400,-1.11020,-1.10596,-1.10129,-1.09619,-1.09067,-1.08472,-1.07836,-1.07158,-1.06440,-1.05682,-1.04884,-1.04048,-1.03173,-1.02261,-1.01312,-1.00327,-0.99306,-0.98252,-0.97163,-0.96041,-0.94888,-0.93703,-0.92488,-0.91244,-0.89971,-0.88670,-0.87343,-0.85991,-0.84614,-0.83213,-0.81790,-0.80346,-0.78881,-0.77396,-0.75893,-0.74373,-0.72836,-0.71284,-0.69718,-0.68139,-0.66548,-0.64945,-0.63333,-0.61712,-0.60084,-0.58448,-0.56807,-0.55161,-0.53512,-0.51860,-0.50206,-0.48552,-0.46899,-0.45246,-0.43597,-0.41950,-0.40308,-0.38671,-0.37040,-0.35416,-0.33799,-0.32192,-0.30594,-0.29007,-0.27430,-0.25866,-0.24314,-0.22776,-0.21252,-0.19743,-0.18249,-0.16772,-0.15311,-0.13868,-0.12443,-0.11036,-0.09648,-0.08280,-0.06932,-0.05604,-0.04298,-0.03012,-0.01749,-0.00507,0.00712,0.01908,0.03081,0.04231,0.05358,0.06460,0.07539,0.08594,0.09624,0.10630,0.11611,0.12568,0.13500,0.14407,0.15290,0.16148,0.16981,0.17789,0.18573,0.19333,0.20067,0.20778,0.21464,0.22126,0.22764,0.23379,0.23970,0.24537,0.25082,0.25603,0.26102,0.26578,0.27032,0.27465,0.27875,0.28265,0.28633,0.28981,0.29308,0.29615,0.29903,0.30171,0.30420,0.30651,0.30863,0.31057,0.31234,0.31394,0.31537,0.31663,0.31774,0.31868,0.31948,0.32013,0.32063,0.32099,0.32121,0.32130,0.32126,0.32110,0.32081,0.32041,0.31989,0.31927,0.31853,0.31770,0.31676,0.31573,0.31461,0.31339,0.31210,0.31072,0.30927,0.30774,0.30614,0.30447,0.30274,0.30094,0.29909,0.29718,0.29522,0.29321,0.29115,0.28905,0.28691,0.28473,0.28252,0.28027,0.27799,0.27568,0.27335,0.27099,0.26862,0.26622,0.26381,0.26138,0.25894,0.25648,0.25402,0.25155,0.24908,0.24660,0.24412,0.24163,0.23915,0.23667,0.23420,0.23173,0.22926,0.22680,0.22435,0.22191,0.21948,0.21707,0.21466,0.21227,0.20989,0.20753,0.20518,0.20285,0.20054,0.19824,0.19597,0.19371,0.19147,0.18925,0.18706,0.18488,0.18273,0.18059,0.17848,0.17639,0.17433,0.17228,0.17026,0.16827,0.16629,0.16434,0.16241,0.16051,0.15863,0.15677,0.15494,0.15313,0.15134,0.14958,0.14784,0.14613,0.14444,0.14277,0.14112,0.13950,0.13790,0.13632,0.13477,0.13323,0.13172,0.13024,0.12877,0.12732,0.12590,0.12450,0.12312,0.12176,0.12042,0.11910,0.11780,0.11651,0.11525,0.11401,0.11279,0.11159,0.11040,0.10923,0.10808,0.10695,0.10584,0.10474,0.10366,0.10259,0.10155,0.10052,0.09950,0.09850,0.09752,0.09655,0.09559,0.09465,0.09373,0.09282,0.09192,0.09103,0.09016,0.08931,0.08846,0.08763,0.08681,0.08601,0.08521,0.08443,0.08366,0.08290,0.08215,0.08141,0.08068,0.07997,0.07926,0.07856,0.07788,0.07720,0.07654,0.07588,0.07523,0.07459,0.07396,0.07334,0.07273,0.07213,0.07153,0.07095,0.07037,0.06980,0.06923,0.06868,0.06813,0.06759,0.06705,0.06653,0.06601,0.06549,0.06499,0.06449,0.06399,0.06350,0.06302,0.06255,0.06208,0.06161,0.06116,0.06071,0.06026,0.05982,0.05938,0.05895,0.05853,0.05811,0.05769,0.05728,0.05688,0.05647,0.05608,0.05569,0.05530,0.05492,0.05454,0.05417,0.05380,0.05343,0.05307,0.05271,0.05236,0.05201,0.05166,0.05132,0.05098,0.05065,0.05032,0.04999,0.04966,0.04934,0.04903,0.04871,0.04840,0.04809,0.04779,0.04749,0.04719,0.04689,0.04660,0.04631,0.04603,0.04574,0.04546,0.04518,0.04491,0.04464,0.04437,0.04410,0.04383,0.04357,0.04331,0.04305,0.04280,0.04255,0.04230,0.04205,0.04180,0.04156,0.04132,0.04108,0.04085,0.04061,0.04038,0.04015,0.03992,0.03970,0.03947,0.03925,0.03903,0.03881,0.03860,0.03838,0.03817,0.03796,0.03775,0.03754,0.03734,0.03714,0.03693,0.03673,0.03654,0.03634,0.03614,0.03595,0.03576,0.03557,0.03538,0.03520,0.03501,0.03483,0.03464,0.03446,0.03428,0.03411,0.03393,0.03376,0.03358,0.03341,0.03324,0.03307,0.03290,0.03273,0.03257,0.03241,0.03224,0.03208,0.03192,0.03176,0.03160,0.03145,0.03129,0.03114,0.03099,0.03083,0.03068,0.03053,0.03038,0.03024,0.03009,0.02995,0.02980,0.02966,0.02952,0.02938,0.02924,0.02910,0.02896,0.02882,0.02869,0.02855,0.02842,0.02829,0.02816,0.02802,0.02789,0.02777,0.02764,0.02751,0.02738,0.02726,0.02713,0.02701,0.02689,0.02677,0.02665,0.02653,0.02641,0.02629,0.02617,0.02605,0.02594,0.02582,0.02571,0.02559,0.02548,0.02537,0.02526,0.02515,0.02504,0.02493,0.02482,0.02471,0.02460,0.02450,0.02439,0.02429,0.02418,0.02408,0.02398,0.02388,0.02377,0.02367,0.02357,0.02347,0.02337,0.02328,0.02318,0.02308,0.02299,0.02289,0.02280,0.02270,0.02261,0.02251,0.02242,0.02233,0.02224,0.02215,0.02206,0.02197,0.02188,0.02179,0.02170,0.02161,0.02153,0.02144,0.02135,0.02127,0.02118,0.02110,0.02101,0.02093,0.02085,0.02077,0.02068,0.02060,0.02052,0.02044,0.02036,0.02028,0.02020,0.02012,0.02005,0.01997,0.01989,0.01981,0.01974,0.01966,0.01959,0.01951,0.01944,0.01936,0.01929,0.01922,0.01914,0.01907,0.01900,0.01893,0.01886,0.01879,0.01872,0.01865,0.01858,0.01851,0.01844,0.01837,0.01830,0.01824,0.01817,0.01810,0.01804,0.01797,0.01790,0.01784,0.01777,0.01771,0.01765,0.01758,0.01752,0.01745,0.01739,0.01733,0.01727,0.01721,0.01714,0.01708,0.01702,0.01696,0.01690,0.01684,0.01678,0.01672,0.01666,0.01661,0.01655,0.01649,0.01643,0.01638,0.01632,0.01626,0.01621,0.01615,0.01609,0.01604,0.01598,0.01593,0.01587,0.01582,0.01576,0.01571,0.01566,0.01560,0.01555,0.01550,0.01545,0.01539,0.01534,0.01529,0.01524,0.01519,0.01514,0.01509,0.01504,0.01499,0.01494,0.01489,0.01484,0.01479,0.01474,0.01469,0.01464,0.01460,0.01455,0.01450,0.01445,0.01441,0.01436,0.01431,0.01427,0.01422,0.01417,0.01413,0.01408,0.01404,0.01399,0.01395,0.01390,0.01386,0.01381,0.01377,0.01373,0.01368,0.01364,0.01360,0.01355,0.01351,0.01347,0.01343,0.01338,0.01334,0.01330,0.01326,0.01322,0.01318,0.01314,0.01309,0.01305,0.01301,0.01297,0.01293,0.01289,0.01285,0.01281,0.01278,0.01274,0.01270,0.01266,0.01262,0.01258,0.01254,0.01251,0.01247,0.01243,0.01239,0.01236,0.01232,0.01228,0.01224,0.01221,0.01217,0.01214,0.01210,0.01206,0.01203,0.01199,0.01196,0.01192,0.01189,0.01185,0.01182,0.01178,0.01175,0.01171,0.01168,0.01164,0.01161,0.01158,0.01154,0.01151,0.01148,0.01144,0.01141,0.01138,0.01134,0.01131,0.01128,0.01125,0.01121,0.01118,0.01115,0.01112,0.01109,0.01106,0.01102,0.01099,0.01096,0.01093,0.01090,0.01087,0.01084,0.01081,0.01078,0.01075,0.01072,0.01069,0.01066,0.01063,0.01060,0.01057,0.01054,0.01051,0.01048,0.01045,0.01042,0.01040,0.01037,0.01034,0.01031,0.01028,0.01025,0.01023,0.01020,0.01017,0.01014,0.01012,0.01009,0.01006,0.01003,0.01001,0.00998,0.00995,0.00993,0.00990,0.00987,0.00985,0.00982,0.00979,0.00977,0.00974,0.00972,0.00969,0.00966,0.00964,0.00961,0.00959,0.00956,0.00954,0.00951,0.00949,0.00946,0.00944,0.00941,0.00939,0.00936,0.00934,0.00931,0.00929,0.00927,0.00924,0.00922,0.00919,0.00917,0.00915,0.00912,0.00910,0.00908,0.00905,0.00903,0.00901,0.00898,0.00896,0.00894,0.00892,0.00889,0.00887,0.00885,0.00883,0.00880,0.00878,0.00876,0.00874,0.00872,0.00869,0.00867,0.00865,0.00863,0.00861,0.00859,0.00856,0.00854,0.00852,0.00850,0.00848,0.00846,0.00844,0.00842,0.00840,0.00837,0.00835,0.00833,0.00831,0.00829,0.00827,0.00825,0.00823,0.00821,0.00819,0.00817,0.00815,0.00813,0.00811,0.00809,0.00807,0.00805,0.00803,0.00802,0.00800,0.00798,0.00796,0.00794,0.00792,0.00790,0.00788,0.00786,0.00784,0.00783,0.00781,0.00779,0.00777,0.00775,0.00773,0.00772,0.00770,0.00768,0.00766,0.00764,0.00762,0.00761,0.00759,0.00757,0.00755,0.00754,0.00752,0.00750,0.00748,0.00747,0.00745,0.00743,0.00741,0.00740,0.00738,0.00736,0.00735,0.00733,0.00731,0.00730,0.00728,0.00726,0.00725,0.00723,0.00721,0.00720,0.00718,0.00716,0.00715,0.00713,0.00711,0.00710,0.00708,0.00707,0.00705,0.00703,0.00702,0.00700,0.00699,0.00697,0.00696,0.00694,0.00692,0.00691,0.00689,0.00688,0.00686,0.00685,0.00683,0.00682,0.00680,0.00679,0.00677,0.00676,0.00674,0.00673,0.00671,0.00670,0.00668,0.00667,0.00665,0.00664,0.00663,0.00661,0.00660,0.00658,0.00657,0.00655,0.00654,0.00652,0.00651,0.00650,0.00648,0.00647,0.00645,0.00644,0.00643,0.00641,0.00640,0.00639,0.00637,0.00636,0.00634,0.00633,0.00632,0.00630,0.00629,0.00628,0.00626,0.00625,0.00624,0.00622,0.00621,0.00620,0.00618,0.00617,0.00616,0.00615,0.00613,0.00612,0.00611,0.00609,0.00608,0.00607,0.00606,0.00604,0.00603,0.00602,0.00601,0.00599,0.00598,0.00597,0.00596,0.00594,0.00593,0.00592,0.00591,0.00590,0.00588,0.00587,0.00586,0.00585,0.00583,0.00582,0.00581,0.00580,0.00579,0.00578,0.00576,0.00575,0.00574,0.00573,0.00572,0.00571,0.00569,0.00568,0.00567,0.00566,0.00565,0.00564,0.00563,0.00561,0.00560,0.00559,0.00558,0.00557,0.00556,0.00555,0.00554,0.00552,0.00551,0.00550,0.00549,0.00548,0.00547,0.00546,0.00545,0.00544,0.00543,0.00542,0.00541,0.00540,0.00538,0.00537,0.00536,0.00535,0.00534,0.00533,0.00532,0.00531,0.00530,0.00529,0.00528,0.00527,0.00526,0.00525,0.00524,0.00523,0.00522,0.00521,0.00520,0.00519,0.00518,0.00517,0.00516,0.00515,0.00514,0.00513,0.00512,0.00511,0.00510,0.00509,0.00508,0.00507,0.00506,0.00505,0.00504,0.00503,0.00502,0.00501,0.00500,0.00499,0.00498,0.00498,0.00497,0.00496,0.00495,0.00494,0.00493,0.00492,0.00491,0.00490,0.00489,0.00488,0.00487,0.00486,0.00485,0.00485,0.00484,0.00483,0.00482,0.00481,0.00480,0.00479,0.00478,0.00477,0.00477,0.00476,0.00475,0.00474,0.00473,0.00472,0.00471,0.00470,0.00470,0.00469,0.00468,0.00467,0.00466,0.00465,0.00464,0.00464,0.00463,0.00462,0.00461,0.00460,0.00459,0.00459,0.00458,0.00457,0.00456,0.00455,0.00454,0.00454,0.00453,0.00452,0.00451,0.00450,0.00450,0.00449,0.00448,0.00447,0.00446,0.00446,0.00445,0.00444,0.00443,0.00442,0.00442,0.00441,0.00440,0.00439,0.00438,0.00438,0.00437,0.00436,0.00435,0.00435,0.00434,0.00433,0.00432,0.00432,0.00431,0.00430,0.00429,0.00429,0.00428,0.00427,0.00426,0.00426,0.00425,0.00424,0.00423,0.00423,0.00422,0.00421,0.00420,0.00420,0.00419,0.00418,0.00417,0.00417,0.00416,0.00415,0.00415,0.00414,0.00413,0.00412,0.00412,0.00411,0.00410,0.00410,0.00409,0.00408,0.00408,0.00407,0.00406,0.00405,0.00405,0.00404,0.00403,0.00403,0.00402,0.00401,0.00401,0.00400,0.00399,0.00399,0.00398,0.00397,0.00397,0.00396,0.00395,0.00395,0.00394,0.00393,0.00393,0.00392,0.00391,0.00391,0.00390,0.00389,0.00389,0.00388,0.00387,0.00387,0.00386,0.00385,0.00385,0.00384,0.00384,0.00383,0.00382,0.00382,0.00381,0.00380,0.00380,0.00379,0.00379,0.00378,0.00377,0.00377,0.00376,0.00375,0.00375,0.00374,0.00374,0.00373,0.00372,0.00372,0.00371,0.00371,0.00370,0.00369,0.00369,0.00368,0.00368,0.00367,0.00366,0.00366,0.00365,0.00365,0.00364,0.00363,0.00363,0.00362,0.00362,0.00361,0.00361,0.00360,0.00359,0.00359,0.00358,0.00358,0.00357,0.00356,0.00356,0.00355,0.00355,0.00354,0.00354,0.00353,0.00353,0.00352,0.00351,0.00351,0.00350,0.00350,0.00349,0.00349,0.00348,0.00348,0.00347,0.00346,0.00346,0.00345,0.00345,0.00344,0.00344,0.00343,0.00343,0.00342,0.00342,0.00341,0.00341,0.00340,0.00339,0.00339,0.00338,0.00338,0.00337,0.00337,0.00336,0.00336,0.00335,0.00335,0.00334,0.00334,0.00333,0.00333,0.00332,0.00332,0.00331,0.00331,0.00330,0.00330,0.00329,0.00329,0.00328,0.00328,0.00327,0.00327,0.00326,0.00326,0.00325,0.00325,0.00324,0.00324,0.00323,0.00323,0.00322,0.00322,0.00321,0.00321,0.00320,0.00320,0.00319,0.00319,0.00318,0.00318,0.00317,0.00317,0.00316,0.00316,0.00315,0.00315,0.00314,0.00314,0.00314,0.00313,0.00313,0.00312,0.00312,0.00311,0.00311,0.00310,0.00310,0.00309,0.00309,0.00308,0.00308,0.00308,0.00307,0.00307,0.00306,0.00306,0.00305,0.00305,0.00304,0.00304,0.00303,0.00303,0.00303,0.00302,0.00302,0.00301,0.00301,0.00300,0.00300,0.00299,0.00299,0.00299,0.00298,0.00298,0.00297,0.00297,0.00296,0.00296,0.00296,0.00295,0.00295,0.00294,0.00294,0.00293,0.00293,0.00293,0.00292,0.00292,0.00291,0.00291,0.00291,0.00290,0.00290,0.00289,0.00289,0.00288,0.00288,0.00288,0.00287,0.00287,0.00286,0.00286,0.00286,0.00285,0.00285,0.00284,0.00284,0.00284,0.00283,0.00283,0.00282,0.00282,0.00282,0.00281,0.00281,0.00280,0.00280,0.00280,0.00279,0.00279,0.00278,0.00278,0.00278,0.00277,0.00277,0.00276,0.00276,0.00276,0.00275,0.00275,0.00274,0.00274,0.00274,0.00273,0.00273,0.00273,0.00272,0.00272,0.00271,0.00271,0.00271,0.00270,0.00270,0.00270,0.00269,0.00269,0.00268,0.00268,0.00268,0.00267,0.00267,0.00267,0.00266,0.00266,0.00265,0.00265,0.00265,0.00264,0.00264,0.00264,0.00263,0.00263,0.00263,0.00262,0.00262,0.00261,0.00261,0.00261,0.00260,0.00260,0.00260,0.00259,0.00259,0.00259,0.00258,0.00258,0.00258,0.00257,0.00257,0.00257,0.00256,0.00256,0.00256,0.00255,0.00255,0.00254,0.00254,0.00254,0.00253,0.00253,0.00253,0.00252,0.00252,0.00252,0.00251,0.00251,0.00251,0.00250,0.00250,0.00250,0.00249,0.00249,0.00249,0.00248,0.00248,0.00248,0.00247,0.00247,0.00247,0.00246,0.00246,0.00246,0.00245,0.00245,0.00245,0.00245,0.00244,0.00244,0.00244,0.00243,0.00243,0.00243,0.00242,0.00242,0.00242,0.00241,0.00241,0.00241,0.00240,0.00240,0.00240,0.00239,0.00239,0.00239,0.00238,0.00238,0.00238,0.00238,0.00237,0.00237,0.00237,0.00236,0.00236,0.00236,0.00235,0.00235,0.00235,0.00234,0.00234,0.00234,0.00234,0.00233,0.00233,0.00233,0.00232,0.00232,0.00232,0.00231,0.00231,0.00231,0.00231,0.00230,0.00230,0.00230,0.00229,0.00229,0.00229,0.00229,0.00228,0.00228,0.00228,0.00227,0.00227,0.00227,0.00227,0.00226,0.00226,0.00226,0.00225,0.00225,0.00225,0.00225,0.00224,0.00224,0.00224,0.00223,0.00223,0.00223,0.00223,0.00222,0.00222,0.00222,0.00221,0.00221,0.00221,0.00221,0.00220,0.00220,0.00220,0.00219,0.00219,0.00219,0.00219,0.00218,0.00218,0.00218,0.00218,0.00217,0.00217,0.00217,0.00216,0.00216,0.00216,0.00216,0.00215,0.00215,0.00215,0.00215,0.00214,0.00214,0.00214,0.00214,0.00213,0.00213,0.00213,0.00213,0.00212,0.00212,0.00212,0.00211,0.00211,0.00211,0.00211,0.00210,0.00210,0.00210,0.00210,0.00209,0.00209,0.00209,0.00209,0.00208,0.00208,0.00208,0.00208,0.00207,0.00207,0.00207,0.00207,0.00206,0.00206,0.00206,0.00206,0.00205,0.00205,0.00205,0.00205,0.00204,0.00204,0.00204,0.00204,0.00203,0.00203,0.00203,0.00203,0.00202,0.00202,0.00202,0.00202,0.00201,0.00201,0.00201,0.00201,0.00200,0.00200,0.00200,0.00200,0.00200,0.00199,0.00199,0.00199,0.00199,0.00198,0.00198,0.00198,0.00198,0.00197,0.00197,0.00197,0.00197,0.00196,0.00196,0.00196,0.00196,0.00196,0.00195,0.00195,0.00195,0.00195,0.00194,0.00194,0.00194,0.00194,0.00193,0.00193,0.00193,0.00193,0.00193,0.00192,0.00192,0.00192,0.00192,0.00191,0.00191,0.00191,0.00191,0.00191,0.00190,0.00190,0.00190,0.00190,0.00189,0.00189,0.00189,0.00189,0.00189,0.00188,0.00188,0.00188,0.00188,0.00187,0.00187,0.00187,0.00187,0.00187,0.00186,0.00186,0.00186,0.00186,0.00186,0.00185,0.00185,0.00185,0.00185,0.00184,0.00184,0.00184,0.00184,0.00184,0.00183,0.00183,0.00183,0.00183,0.00183,0.00182,0.00182,0.00182,0.00182,0.00182,0.00181,0.00181,0.00181,0.00181,0.00181,0.00180,0.00180,0.00180,0.00180,0.00180,0.00179,0.00179,0.00179,0.00179,0.00179,0.00178,0.00178,0.00178,0.00178,0.00178,0.00177,0.00177,0.00177,0.00177,0.00177,0.00176,0.00176,0.00176,0.00176,0.00176,0.00175,0.00175,0.00175,0.00175,0.00175,0.00174,0.00174,0.00174,0.00174,0.00174,0.00173,0.00173,0.00173,0.00173,0.00173,0.00172,0.00172,0.00172,0.00172,0.00172,0.00171,0.00171,0.00171,0.00171,0.00171,0.00171,0.00170,0.00170,0.00170,0.00170,0.00170,0.00169,0.00169,0.00169,0.00169,0.00169,0.00168,0.00168,0.00168,0.00168,0.00168,0.00168,0.00167,0.00167,0.00167,0.00167,0.00167,0.00166,0.00166,0.00166,0.00166,0.00166,0.00166,0.00165,0.00165,0.00165,0.00165,0.00165,0.00165,0.00164,0.00164,0.00164,0.00164,0.00164,0.00163,0.00163,0.00163,0.00163,0.00163,0.00163,0.00162,0.00162,0.00162,0.00162,0.00162,0.00162,0.00161,0.00161,0.00161,0.00161,0.00161,0.00160,0.00160,0.00160,0.00160,0.00160,0.00160,0.00159,0.00159,0.00159,0.00159,0.00159,0.00159,0.00158,0.00158,0.00158,0.00158,0.00158,0.00158,0.00157,0.00157,0.00157,0.00157,0.00157,0.00157,0.00156,0.00156,0.00156,0.00156,0.00156,0.00156,0.00155,0.00155,0.00155,0.00155,0.00155,0.00155,0.00154,0.00154,0.00154,0.00154,0.00154,0.00154,0.00154,0.00153,0.00153,0.00153,0.00153,0.00153,0.00153,0.00152,0.00152,0.00152,0.00152,0.00152,0.00152,0.00151,0.00151,0.00151,0.00151,0.00151,0.00151,0.00151,0.00150,0.00150,0.00150,0.00150,0.00150,0.00150,0.00149,0.00149,0.00149,0.00149,0.00149,0.00149,0.00149,0.00148,0.00148,0.00148,0.00148,0.00148,0.00148,0.00147,0.00147,0.00147,0.00147,0.00147,0.00147,0.00147,0.00146,0.00146,0.00146,0.00146,0.00146,0.00146,0.00145,0.00145,0.00145,0.00145,0.00145,0.00145,0.00145,0.00144,0.00144,0.00144,0.00144,0.00144,0.00144,0.00144,0.00143,0.00143,0.00143,0.00143,0.00143,0.00143,0.00143,0.00142,0.00142,0.00142,0.00142,0.00142,0.00142];var quasar_rest_wavelength=[548.9,549.4,549.9,550.4,550.9,551.4,551.9,552.4,552.9,553.4,553.9,554.4,554.9,555.4,555.9,556.4,556.9,557.4,557.9,558.4,558.9,559.4,559.9,560.4,560.9,561.4,561.9,562.4,562.9,563.4,563.9,564.4,564.9,565.4,565.9,566.4,566.9,567.4,567.9,568.4,568.9,569.4,569.9,570.4,570.9,571.4,571.9,572.4,572.9,573.3,573.8,574.3,574.8,575.3,575.8,576.3,576.8,577.3,577.8,578.3,578.8,579.3,579.8,580.3,580.8,581.3,581.8,582.3,582.8,583.3,583.8,584.3,584.8,585.3,585.8,586.3,586.8,587.3,587.8,588.3,588.8,589.3,589.8,590.3,590.8,591.3,591.8,592.3,592.8,593.3,593.8,594.3,594.8,595.3,595.8,596.3,596.8,597.3,597.8,598.3,598.8,599.3,599.8,600.3,600.8,601.3,601.8,602.3,602.8,603.3,603.8,604.3,604.8,605.3,605.8,606.3,606.8,607.3,607.8,608.2,608.7,609.2,609.7,610.2,610.7,611.2,611.7,612.2,612.7,613.2,613.7,614.2,614.7,615.2,615.7,616.2,616.7,617.2,617.7,618.2,618.7,619.2,619.7,620.2,620.7,621.2,621.7,622.2,622.7,623.2,623.7,624.2,624.7,625.2,625.7,626.2,626.7,627.2,627.7,628.2,628.7,629.2,629.7,630.2,630.7,631.2,631.7,632.2,632.7,633.2,633.7,634.2,634.7,635.2,635.7,636.2,636.7,637.2,637.7,638.2,638.7,639.2,639.7,640.2,640.7,641.2,641.7,642.2,642.7,643.1,643.6,644.1,644.6,645.1,645.6,646.1,646.6,647.1,647.6,648.1,648.6,649.1,649.6,650.1,650.6,651.1,651.6,652.1,652.6,653.1,653.6,654.1,654.6,655.1,655.6,656.1,656.6,657.1,657.6,658.1,658.6,659.1,659.6,660.1,660.6,661.1,661.6,662.1,662.6,663.1,663.6,664.1,664.6,665.1,665.6,666.1,666.6,667.1,667.6,668.1,668.6,669.1,669.6,670.1,670.6,671.1,671.6,672.1,672.6,673.1,673.6,674.1,674.6,675.1,675.6,676.1,676.6,677.1,677.5,678,678.5,679,679.5,680,680.5,681,681.5,682,682.5,683,683.5,684,684.5,685,685.5,686,686.5,687,687.5,688,688.5,689,689.5,690,690.5,691,691.5,692,692.5,693,693.5,694,694.5,695,695.5,696,696.5,697,697.5,698,698.5,699,699.5,700,700.5,701,701.5,702,702.5,703,703.5,704,704.5,705,705.5,706,706.5,707,707.5,708,708.5,709,709.5,710,710.5,711,711.5,712,712.4,712.9,713.4,713.9,714.4,714.9,715.4,715.9,716.4,716.9,717.4,717.9,718.4,718.9,719.4,719.9,720.4,720.9,721.4,721.9,722.4,722.9,723.4,723.9,724.4,724.9,725.4,725.9,726.4,726.9,727.4,727.9,728.4,728.9,729.4,729.9,730.4,730.9,731.4,731.9,732.4,732.9,733.4,733.9,734.4,734.9,735.4,735.9,736.4,736.9,737.4,737.9,738.4,738.9,739.4,739.9,740.4,740.9,741.4,741.9,742.4,742.9,743.4,743.9,744.4,744.9,745.4,745.9,746.4,746.9,747.3,747.8,748.3,748.8,749.3,749.8,750.3,750.8,751.3,751.8,752.3,752.8,753.3,753.8,754.3,754.8,755.3,755.8,756.3,756.8,757.3,757.8,758.3,758.8,759.3,759.8,760.3,760.8,761.3,761.8,762.3,762.8,763.3,763.8,764.3,764.8,765.3,765.8,766.3,766.8,767.3,767.8,768.3,768.8,769.3,769.8,770.3,770.8,771.3,771.8,772.3,772.8,773.3,773.8,774.3,774.8,775.3,775.8,776.3,776.8,777.3,777.8,778.3,778.8,779.3,779.8,780.3,780.8,781.3,781.7,782.2,782.7,783.2,783.7,784.2,784.7,785.2,785.7,786.2,786.7,787.2,787.7,788.2,788.7,789.2,789.7,790.2,790.7,791.2,791.7,792.2,792.7,793.2,793.7,794.2,794.7,795.2,795.7,796.2,796.7,797.2,797.7,798.2,798.7,799.2,799.7,800.2,800.7,801.2,801.7,802.2,802.7,803.2,803.7,804.2,804.7,805.2,805.7,806.2,806.7,807.2,807.7,808.2,808.7,809.2,809.7,810.2,810.7,811.2,811.7,812.2,812.7,813.2,813.7,814.2,814.7,815.2,815.7,816.2,816.6,817.1,817.6,818.1,818.6,819.1,819.6,820.1,820.6,821.1,821.6,822.1,822.6,823.1,823.6,824.1,824.6,825.1,825.6,826.1,826.6,827.1,827.6,828.1,828.6,829.1,829.6,830.1,830.6,831.1,831.6,832.1,832.6,833.1,833.6,834.1,834.6,835.1,835.6,836.1,836.6,837.1,837.6,838.1,838.6,839.1,839.6,840.1,840.6,841.1,841.6,842.1,842.6,843.1,843.6,844.1,844.6,845.1,845.6,846.1,846.6,847.1,847.6,848.1,848.6,849.1,849.6,850.1,850.6,851.1,851.5,852,852.5,853,853.5,854,854.5,855,855.5,856,856.5,857,857.5,858,858.5,859,859.5,860,860.5,861,861.5,862,862.5,863,863.5,864,864.5,865,865.5,866,866.5,867,867.5,868,868.5,869,869.5,870,870.5,871,871.5,872,872.5,873,873.5,874,874.5,875,875.5,876,876.5,877,877.5,878,878.5,879,879.5,880,880.5,881,881.5,882,882.5,883,883.5,884,884.5,885,885.5,885.9,886.4,886.9,887.4,887.9,888.4,888.9,889.4,889.9,890.4,890.9,891.4,891.9,892.4,892.9,893.4,893.9,894.4,894.9,895.4,895.9,896.4,896.9,897.4,897.9,898.4,898.9,899.4,899.9,900.4,900.9,901.4,901.9,902.4,902.9,903.4,903.9,904.4,904.9,905.4,905.9,906.4,906.9,907.4,907.9,908.4,908.9,909.4,909.9,910.4,910.9,911.4,911.9,912.4,912.9,913.4,913.9,914.4,914.9,915.4,915.9,916.4,916.9,917.4,917.9,918.4,918.9,919.4,919.9,920.4,920.8,921.3,921.8,922.3,922.8,923.3,923.8,924.3,924.8,925.3,925.8,926.3,926.8,927.3,927.8,928.3,928.8,929.3,929.8,930.3,930.8,931.3,931.8,932.3,932.8,933.3,933.8,934.3,934.8,935.3,935.8,936.3,936.8,937.3,937.8,938.3,938.8,939.3,939.8,940.3,940.8,941.3,941.8,942.3,942.8,943.3,943.8,944.3,944.8,945.3,945.8,946.3,946.8,947.3,947.8,948.3,948.8,949.3,949.8,950.3,950.8,951.3,951.8,952.3,952.8,953.3,953.8,954.3,954.8,955.3,955.7,956.2,956.7,957.2,957.7,958.2,958.7,959.2,959.7,960.2,960.7,961.2,961.7,962.2,962.7,963.2,963.7,964.2,964.7,965.2,965.7,966.2,966.7,967.2,967.7,968.2,968.7,969.2,969.7,970.2,970.7,971.2,971.7,972.2,972.7,973.2,973.7,974.2,974.7,975.2,975.7,976.2,976.7,977.2,977.7,978.2,978.7,979.2,979.7,980.2,980.7,981.2,981.7,982.2,982.7,983.2,983.7,984.2,984.7,985.2,985.7,986.2,986.7,987.2,987.7,988.2,988.7,989.2,989.7,990.2,990.6,991.1,991.6,992.1,992.6,993.1,993.6,994.1,994.6,995.1,995.6,996.1,996.6,997.1,997.6,998.1,998.6,999.1,999.6,1000.1,1000.6,1001.1,1001.6,1002.1,1002.6,1003.1,1003.6,1004.1,1004.6,1005.1,1005.6,1006.1,1006.6,1007.1,1007.6,1008.1,1008.6,1009.1,1009.6,1010.1,1010.6,1011.1,1011.6,1012.1,1012.6,1013.1,1013.6,1014.1,1014.6,1015.1,1015.6,1016.1,1016.6,1017.1,1017.6,1018.1,1018.6,1019.1,1019.6,1020.1,1020.6,1021.1,1021.6,1022.1,1022.6,1023.1,1023.6,1024.1,1024.6,1025,1025.5,1026,1026.5,1027,1027.5,1028,1028.5,1029,1029.5,1030,1030.5,1031,1031.5,1032,1032.5,1033,1033.5,1034,1034.5,1035,1035.5,1036,1036.5,1037,1037.5,1038,1038.5,1039,1039.5,1040,1040.5,1041,1041.5,1042,1042.5,1043,1043.5,1044,1044.5,1045,1045.5,1046,1046.5,1047,1047.5,1048,1048.5,1049,1049.5,1050,1050.5,1051,1051.5,1052,1052.5,1053,1053.5,1054,1054.5,1055,1055.5,1056,1056.5,1057,1057.5,1058,1058.5,1059,1059.5,1059.9,1060.4,1060.9,1061.4,1061.9,1062.4,1062.9,1063.4,1063.9,1064.4,1064.9,1065.4,1065.9,1066.4,1066.9,1067.4,1067.9,1068.4,1068.9,1069.4,1069.9,1070.4,1070.9,1071.4,1071.9,1072.4,1072.9,1073.4,1073.9,1074.4,1074.9,1075.4,1075.9,1076.4,1076.9,1077.4,1077.9,1078.4,1078.9,1079.4,1079.9,1080.4,1080.9,1081.4,1081.9,1082.4,1082.9,1083.4,1083.9,1084.4,1084.9,1085.4,1085.9,1086.4,1086.9,1087.4,1087.9,1088.4,1088.9,1089.4,1089.9,1090.4,1090.9,1091.4,1091.9,1092.4,1092.9,1093.4,1093.9,1094.4,1094.8,1095.3,1095.8,1096.3,1096.8,1097.3,1097.8,1098.3,1098.8,1099.3,1099.8,1100.3,1100.8,1101.3,1101.8,1102.3,1102.8,1103.3,1103.8,1104.3,1104.8,1105.3,1105.8,1106.3,1106.8,1107.3,1107.8,1108.3,1108.8,1109.3,1109.8,1110.3,1110.8,1111.3,1111.8,1112.3,1112.8,1113.3,1113.8,1114.3,1114.8,1115.3,1115.8,1116.3,1116.8,1117.3,1117.8,1118.3,1118.8,1119.3,1119.8,1120.3,1120.8,1121.3,1121.8,1122.3,1122.8,1123.3,1123.8,1124.3,1124.8,1125.3,1125.8,1126.3,1126.8,1127.3,1127.8,1128.3,1128.8,1129.2,1129.7,1130.2,1130.7,1131.2,1131.7,1132.2,1132.7,1133.2,1133.7,1134.2,1134.7,1135.2,1135.7,1136.2,1136.7,1137.2,1137.7,1138.2,1138.7,1139.2,1139.7,1140.2,1140.7,1141.2,1141.7,1142.2,1142.7,1143.2,1143.7,1144.2,1144.7,1145.2,1145.7,1146.2,1146.7,1147.2,1147.7,1148.2,1148.7,1149.2,1149.7,1150.2,1150.7,1151.2,1151.7,1152.2,1152.7,1153.2,1153.7,1154.2,1154.7,1155.2,1155.7,1156.2,1156.7,1157.2,1157.7,1158.2,1158.7,1159.2,1159.7,1160.2,1160.7,1161.2,1161.7,1162.2,1162.7,1163.2,1163.7,1164.1,1164.6,1165.1,1165.6,1166.1,1166.6,1167.1,1167.6,1168.1,1168.6,1169.1,1169.6,1170.1,1170.6,1171.1,1171.6,1172.1,1172.6,1173.1,1173.6,1174.1,1174.6,1175.1,1175.6,1176.1,1176.6,1177.1,1177.6,1178.1,1178.6,1179.1,1179.6,1180.1,1180.6,1181.1,1181.6,1182.1,1182.6,1183.1,1183.6,1184.1,1184.6,1185.1,1185.6,1186.1,1186.6,1187.1,1187.6,1188.1,1188.6,1189.1,1189.6,1190.1,1190.6,1191.1,1191.6,1192.1,1192.6,1193.1,1193.6,1194.1,1194.6,1195.1,1195.6,1196.1,1196.6,1197.1,1197.6,1198.1,1198.6,1199,1199.5,1200,1200.5,1201,1201.5,1202,1202.5,1203,1203.5,1204,1204.5,1205,1205.5,1206,1206.5,1207,1207.5,1208,1208.5,1209,1209.5,1210,1210.5,1211,1211.5,1212,1212.5,1213,1213.5,1214,1214.5,1215,1215.5,1216,1216.5,1217,1217.5,1218,1218.5,1219,1219.5,1220,1220.5,1221,1221.5,1222,1222.5,1223,1223.5,1224,1224.5,1225,1225.5,1226,1226.5,1227,1227.5,1228,1228.5,1229,1229.5,1230,1230.5,1231,1231.5,1232,1232.5,1233,1233.4,1233.9,1234.4,1234.9,1235.4,1235.9,1236.4,1236.9,1237.4,1237.9,1238.4,1238.9,1239.4,1239.9,1240.4,1240.9,1241.4,1241.9,1242.4,1242.9,1243.4,1243.9,1244.4,1244.9,1245.4,1245.9,1246.4,1246.9,1247.4,1247.9,1248.4,1248.9,1249.4,1249.9,1250.4,1250.9,1251.4,1251.9,1252.4,1252.9,1253.4,1253.9,1254.4,1254.9,1255.4,1255.9,1256.4,1256.9,1257.4,1257.9,1258.4,1258.9,1259.4,1259.9,1260.4,1260.9,1261.4,1261.9,1262.4,1262.9,1263.4,1263.9,1264.4,1264.9,1265.4,1265.9,1266.4,1266.9,1267.4,1267.9,1268.3,1268.8,1269.3,1269.8,1270.3,1270.8,1271.3,1271.8,1272.3,1272.8,1273.3,1273.8,1274.3,1274.8,1275.3,1275.8,1276.3,1276.8,1277.3,1277.8,1278.3,1278.8,1279.3,1279.8,1280.3,1280.8,1281.3,1281.8,1282.3,1282.8,1283.3,1283.8,1284.3,1284.8,1285.3,1285.8,1286.3,1286.8,1287.3,1287.8,1288.3,1288.8,1289.3,1289.8,1290.3,1290.8,1291.3,1291.8,1292.3,1292.8,1293.3,1293.8,1294.3,1294.8,1295.3,1295.8,1296.3,1296.8,1297.3,1297.8,1298.3,1298.8,1299.3,1299.8,1300.3,1300.8,1301.3,1301.8,1302.3,1302.8,1303.2,1303.7,1304.2,1304.7,1305.2,1305.7,1306.2,1306.7,1307.2,1307.7,1308.2,1308.7,1309.2,1309.7,1310.2,1310.7,1311.2,1311.7,1312.2,1312.7,1313.2,1313.7,1314.2,1314.7,1315.2,1315.7,1316.2,1316.7,1317.2,1317.7,1318.2,1318.7,1319.2,1319.7,1320.2,1320.7,1321.2,1321.7,1322.2,1322.7,1323.2,1323.7,1324.2,1324.7,1325.2,1325.7,1326.2,1326.7,1327.2,1327.7,1328.2,1328.7,1329.2,1329.7,1330.2,1330.7,1331.2,1331.7,1332.2,1332.7,1333.2,1333.7,1334.2,1334.7,1335.2,1335.7,1336.2,1336.7,1337.2,1337.6,1338.1,1338.6,1339.1,1339.6,1340.1,1340.6,1341.1,1341.6,1342.1,1342.6,1343.1,1343.6,1344.1,1344.6,1345.1,1345.6,1346.1,1346.6,1347.1,1347.6,1348.1,1348.6,1349.1,1349.6,1350.1,1350.6,1351.1,1351.6,1352.1,1352.6,1353.1,1353.6,1354.1,1354.6,1355.1,1355.6,1356.1,1356.6,1357.1,1357.6,1358.1,1358.6,1359.1,1359.6,1360.1,1360.6,1361.1,1361.6,1362.1,1362.6,1363.1,1363.6,1364.1,1364.6,1365.1,1365.6,1366.1,1366.6,1367.1,1367.6,1368.1,1368.6,1369.1,1369.6,1370.1,1370.6,1371.1,1371.6,1372.1,1372.5,1373,1373.5,1374,1374.5,1375,1375.5,1376,1376.5,1377,1377.5,1378,1378.5,1379,1379.5,1380,1380.5,1381,1381.5,1382,1382.5,1383,1383.5,1384,1384.5,1385,1385.5,1386,1386.5,1387,1387.5,1388,1388.5,1389,1389.5,1390,1390.5,1391,1391.5,1392,1392.5,1393,1393.5,1394,1394.5,1395,1395.5,1396,1396.5,1397,1397.5,1398,1398.5,1399,1399.5,1400,1400.5,1401,1401.5,1402,1402.5,1403,1403.5,1404,1404.5,1405,1405.5,1406,1406.5,1407,1407.4,1407.9,1408.4,1408.9,1409.4,1409.9,1410.4,1410.9,1411.4,1411.9,1412.4,1412.9,1413.4,1413.9,1414.4,1414.9,1415.4,1415.9,1416.4,1416.9,1417.4,1417.9,1418.4,1418.9,1419.4,1419.9,1420.4,1420.9,1421.4,1421.9,1422.4,1422.9,1423.4,1423.9,1424.4,1424.9,1425.4,1425.9,1426.4,1426.9,1427.4,1427.9,1428.4,1428.9,1429.4,1429.9,1430.4,1430.9,1431.4,1431.9,1432.4,1432.9,1433.4,1433.9,1434.4,1434.9,1435.4,1435.9,1436.4,1436.9,1437.4,1437.9,1438.4,1438.9,1439.4,1439.9,1440.4,1440.9,1441.4,1441.8,1442.3,1442.8,1443.3,1443.8,1444.3,1444.8,1445.3,1445.8,1446.3,1446.8,1447.3,1447.8,1448.3,1448.8,1449.3,1449.8,1450.3,1450.8,1451.3,1451.8,1452.3,1452.8,1453.3,1453.8,1454.3,1454.8,1455.3,1455.8,1456.3,1456.8,1457.3,1457.8,1458.3,1458.8,1459.3,1459.8,1460.3,1460.8,1461.3,1461.8,1462.3,1462.8,1463.3,1463.8,1464.3,1464.8,1465.3,1465.8,1466.3,1466.8,1467.3,1467.8,1468.3,1468.8,1469.3,1469.8,1470.3,1470.8,1471.3,1471.8,1472.3,1472.8,1473.3,1473.8,1474.3,1474.8,1475.3,1475.8,1476.3,1476.7,1477.2,1477.7,1478.2,1478.7,1479.2,1479.7,1480.2,1480.7,1481.2,1481.7,1482.2,1482.7,1483.2,1483.7,1484.2,1484.7,1485.2,1485.7,1486.2,1486.7,1487.2,1487.7,1488.2,1488.7,1489.2,1489.7,1490.2,1490.7,1491.2,1491.7,1492.2,1492.7,1493.2,1493.7,1494.2,1494.7,1495.2,1495.7,1496.2,1496.7,1497.2,1497.7,1498.2,1498.7,1499.2,1499.7,1500.2,1500.7,1501.2,1501.7,1502.2,1502.7,1503.2,1503.7,1504.2,1504.7,1505.2,1505.7,1506.2,1506.7,1507.2,1507.7,1508.2,1508.7,1509.2,1509.7,1510.2,1510.7,1511.2,1511.6,1512.1,1512.6,1513.1,1513.6,1514.1,1514.6,1515.1,1515.6,1516.1,1516.6,1517.1,1517.6,1518.1,1518.6,1519.1,1519.6,1520.1,1520.6,1521.1,1521.6,1522.1,1522.6,1523.1,1523.6,1524.1,1524.6,1525.1,1525.6,1526.1,1526.6,1527.1,1527.6,1528.1,1528.6,1529.1,1529.6,1530.1,1530.6,1531.1,1531.6,1532.1,1532.6,1533.1,1533.6,1534.1,1534.6,1535.1,1535.6,1536.1,1536.6,1537.1,1537.6,1538.1,1538.6,1539.1,1539.6,1540.1,1540.6,1541.1,1541.6,1542.1,1542.6,1543.1,1543.6,1544.1,1544.6,1545.1,1545.6];var quasar_rest_flux=[13.5,13.48,13.47,13.46,13.45,13.44,13.43,13.42,13.41,13.4,13.38,13.37,13.36,13.35,13.34,13.33,13.32,13.31,13.3,13.29,13.28,13.27,13.25,13.24,13.23,13.22,13.21,13.2,13.19,13.18,13.17,13.16,13.15,13.14,13.13,13.12,13.11,13.1,13.09,13.07,13.06,13.05,13.04,13.03,13.02,13.01,13,12.99,12.98,12.97,12.96,12.95,12.94,12.93,12.92,12.91,12.9,12.89,12.88,12.87,12.86,12.85,12.84,12.83,12.82,12.81,12.8,12.79,12.78,12.77,12.76,12.75,12.74,12.73,12.72,12.71,12.7,12.69,12.68,12.67,12.66,12.65,12.64,12.63,12.62,12.61,12.6,12.59,12.58,12.57,12.56,12.55,12.55,12.54,12.53,12.52,12.51,12.5,12.49,12.48,12.47,12.46,12.45,12.44,12.43,12.42,12.41,12.4,12.39,12.38,12.38,12.37,12.36,12.35,12.34,12.33,12.32,12.31,12.3,12.29,12.28,12.27,12.26,12.26,12.25,12.24,12.23,12.22,12.21,12.2,12.19,12.18,12.17,12.17,12.16,12.15,12.14,12.13,12.12,12.11,12.1,12.09,12.08,12.08,12.07,12.06,12.05,12.04,12.03,12.02,12.01,12.01,12,11.99,11.98,11.97,11.96,11.95,11.94,11.94,11.93,11.92,11.91,11.9,11.89,11.88,11.88,11.87,11.86,11.85,11.84,11.83,11.82,11.82,11.81,11.8,11.79,11.78,11.77,11.77,11.76,11.75,11.74,11.73,11.72,11.72,11.71,11.7,11.69,11.68,11.67,11.67,11.66,11.65,11.64,11.63,11.62,11.62,11.61,11.6,11.59,11.58,11.58,11.57,11.56,11.55,11.54,11.54,11.53,11.52,11.51,11.5,11.5,11.49,11.48,11.47,11.46,11.46,11.45,11.44,11.43,11.42,11.42,11.41,11.4,11.39,11.38,11.38,11.37,11.36,11.35,11.35,11.34,11.33,11.32,11.31,11.31,11.3,11.29,11.28,11.28,11.27,11.26,11.25,11.24,11.24,11.23,11.22,11.21,11.21,11.2,11.19,11.18,11.18,11.17,11.16,11.15,11.15,11.14,11.13,11.12,11.12,11.11,11.1,11.09,11.09,11.08,11.07,11.06,11.06,11.05,11.04,11.03,11.03,11.02,11.01,11.01,11,10.99,10.98,10.98,10.97,10.96,10.95,10.95,10.94,10.93,10.93,10.92,10.91,10.9,10.9,10.89,10.88,10.87,10.87,10.86,10.85,10.85,10.84,10.83,10.82,10.82,10.81,10.8,10.8,10.79,10.78,10.78,10.77,10.76,10.75,10.75,10.74,10.73,10.73,10.72,10.71,10.71,10.7,10.69,10.69,10.68,10.67,10.66,10.66,10.65,10.64,10.64,10.63,10.62,10.62,10.61,10.6,10.6,10.59,10.58,10.58,10.57,10.56,10.56,10.55,10.54,10.54,10.53,10.52,10.52,10.51,10.5,10.5,10.49,10.48,10.48,10.47,10.46,10.46,10.45,10.44,10.44,10.43,10.42,10.42,10.41,10.4,10.4,10.39,10.38,10.38,10.37,10.36,10.36,10.35,10.34,10.34,10.33,10.32,10.32,10.31,10.31,10.3,10.29,10.29,10.28,10.27,10.27,10.26,10.25,10.25,10.24,10.24,10.23,10.22,10.22,10.21,10.2,10.2,10.19,10.18,10.18,10.17,10.17,10.16,10.15,10.15,10.14,10.13,10.13,10.12,10.12,10.11,10.1,10.1,10.09,10.09,10.08,10.07,10.07,10.06,10.05,10.05,10.04,10.04,10.03,10.02,10.02,10.01,10.01,10,9.99,9.99,9.98,9.98,9.97,9.96,9.96,9.95,9.95,9.94,9.93,9.93,9.92,9.92,9.91,9.9,9.9,9.89,9.89,9.88,9.87,9.87,9.86,9.86,9.85,9.84,9.84,9.83,9.83,9.82,9.82,9.81,9.8,9.8,9.79,9.79,9.78,9.77,9.77,9.76,9.76,9.75,9.75,9.74,9.73,9.73,9.72,9.72,9.71,9.71,9.7,9.69,9.69,9.68,9.68,9.67,9.67,9.66,9.65,9.65,9.64,9.64,9.63,9.63,9.62,9.61,9.61,9.6,9.6,9.59,9.59,9.58,9.58,9.57,9.57,9.56,9.56,9.55,9.55,9.54,9.53,9.53,9.52,9.52,9.51,9.51,9.5,9.5,9.49,9.49,9.48,9.48,9.47,9.46,9.46,9.45,9.45,9.44,9.44,9.43,9.43,9.42,9.42,9.41,9.41,9.4,9.4,9.39,9.39,9.38,9.38,9.37,9.36,9.36,9.35,9.35,9.34,9.34,9.33,9.33,9.32,9.32,9.31,9.31,9.3,9.3,9.29,9.29,9.28,9.28,9.27,9.27,9.26,9.26,9.25,9.25,9.24,9.24,9.23,9.23,9.22,9.22,9.21,9.21,9.2,9.19,9.19,9.18,9.18,9.17,9.17,9.16,9.16,9.15,9.15,9.14,9.14,9.13,9.13,9.12,9.12,9.11,9.11,9.1,9.1,9.09,9.09,9.08,9.08,9.07,9.07,9.06,9.06,9.05,9.05,9.04,9.04,9.03,9.03,9.02,9.02,9.02,9.01,9.01,9,9,8.99,8.99,8.98,8.98,8.97,8.97,8.96,8.96,8.95,8.95,8.94,8.94,8.93,8.93,8.92,8.92,8.91,8.91,8.9,8.9,8.9,8.89,8.89,8.88,8.88,8.87,8.87,8.86,8.86,8.85,8.85,8.84,8.84,8.84,8.83,8.83,8.82,8.82,8.81,8.81,8.8,8.8,8.8,8.79,8.79,8.78,8.78,8.77,8.77,8.76,8.76,8.76,8.75,8.75,8.74,8.74,8.73,8.73,8.73,8.72,8.72,8.71,8.71,8.7,8.7,8.7,8.69,8.69,8.68,8.68,8.68,8.67,8.67,8.66,8.66,8.65,8.65,8.65,8.64,8.64,8.63,8.63,8.63,8.62,8.62,8.61,8.61,8.61,8.6,8.6,8.59,8.59,8.59,8.58,8.58,8.57,8.57,8.57,8.56,8.56,8.56,8.55,8.55,8.54,8.54,8.54,8.53,8.53,8.53,8.52,8.52,8.51,8.51,8.51,8.5,8.5,8.5,8.49,8.49,8.48,8.48,8.48,8.47,8.47,8.47,8.46,8.46,8.46,8.45,8.45,8.44,8.44,8.44,8.43,8.43,8.43,8.42,8.42,8.42,8.41,8.41,8.4,8.4,8.4,8.39,8.39,8.39,8.38,8.38,8.37,8.37,8.37,8.36,8.36,8.36,8.35,8.35,8.34,8.34,8.34,8.33,8.33,8.33,8.32,8.32,8.31,8.31,8.31,8.3,8.3,8.29,8.29,8.29,8.28,8.28,8.27,8.27,8.27,8.26,8.26,8.25,8.25,8.25,8.24,8.24,8.23,8.23,8.23,8.22,8.22,8.21,8.21,8.21,8.2,8.2,8.19,8.19,8.19,8.18,8.18,8.17,8.17,8.17,8.16,8.16,8.16,8.15,8.15,8.14,8.14,8.14,8.13,8.13,8.13,8.12,8.12,8.12,8.11,8.11,8.11,8.1,8.1,8.1,8.09,8.09,8.09,8.09,8.08,8.08,8.08,8.07,8.07,8.07,8.07,8.06,8.06,8.06,8.06,8.06,8.05,8.05,8.05,8.05,8.05,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.03,8.03,8.03,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.04,8.05,8.05,8.05,8.06,8.06,8.06,8.07,8.07,8.08,8.08,8.09,8.09,8.1,8.11,8.11,8.12,8.13,8.14,8.14,8.15,8.16,8.17,8.18,8.19,8.2,8.21,8.23,8.24,8.25,8.26,8.27,8.29,8.3,8.31,8.33,8.34,8.35,8.37,8.38,8.4,8.41,8.43,8.44,8.45,8.47,8.48,8.5,8.51,8.53,8.54,8.55,8.57,8.58,8.59,8.6,8.62,8.63,8.64,8.65,8.66,8.67,8.68,8.69,8.69,8.7,8.71,8.71,8.72,8.72,8.72,8.73,8.73,8.73,8.73,8.73,8.72,8.72,8.72,8.71,8.71,8.7,8.69,8.69,8.68,8.67,8.66,8.65,8.63,8.62,8.61,8.59,8.58,8.56,8.55,8.53,8.51,8.5,8.48,8.46,8.44,8.42,8.4,8.38,8.36,8.34,8.32,8.29,8.27,8.25,8.23,8.21,8.19,8.16,8.14,8.12,8.1,8.08,8.06,8.04,8.02,7.99,7.97,7.95,7.93,7.92,7.9,7.88,7.86,7.84,7.82,7.8,7.79,7.77,7.75,7.74,7.72,7.71,7.69,7.68,7.66,7.65,7.64,7.62,7.61,7.6,7.59,7.58,7.57,7.55,7.54,7.53,7.52,7.51,7.5,7.49,7.49,7.48,7.47,7.46,7.45,7.44,7.44,7.43,7.42,7.41,7.41,7.4,7.39,7.39,7.38,7.37,7.37,7.36,7.36,7.35,7.34,7.34,7.33,7.33,7.32,7.32,7.31,7.31,7.3,7.3,7.29,7.29,7.28,7.28,7.27,7.27,7.26,7.26,7.25,7.25,7.24,7.24,7.23,7.23,7.23,7.22,7.22,7.21,7.21,7.21,7.2,7.2,7.19,7.19,7.19,7.18,7.18,7.17,7.17,7.17,7.16,7.16,7.16,7.15,7.15,7.15,7.14,7.14,7.14,7.13,7.13,7.13,7.13,7.12,7.12,7.12,7.11,7.11,7.11,7.1,7.1,7.1,7.1,7.09,7.09,7.09,7.08,7.08,7.08,7.07,7.07,7.07,7.07,7.06,7.06,7.06,7.05,7.05,7.05,7.04,7.04,7.04,7.03,7.03,7.02,7.02,7.02,7.01,7.01,7.01,7,7,6.99,6.99,6.99,6.98,6.98,6.97,6.97,6.96,6.96,6.96,6.95,6.95,6.94,6.94,6.93,6.93,6.92,6.92,6.91,6.91,6.91,6.9,6.9,6.89,6.89,6.88,6.88,6.87,6.87,6.86,6.86,6.85,6.85,6.84,6.84,6.84,6.83,6.83,6.82,6.82,6.81,6.81,6.8,6.8,6.79,6.79,6.79,6.78,6.78,6.77,6.77,6.76,6.76,6.76,6.75,6.75,6.74,6.74,6.74,6.73,6.73,6.72,6.72,6.72,6.71,6.71,6.71,6.7,6.7,6.7,6.7,6.69,6.69,6.69,6.68,6.68,6.68,6.68,6.67,6.67,6.67,6.67,6.67,6.66,6.66,6.66,6.66,6.66,6.66,6.66,6.65,6.65,6.65,6.65,6.65,6.65,6.65,6.65,6.65,6.65,6.66,6.66,6.66,6.66,6.66,6.66,6.67,6.67,6.67,6.68,6.68,6.69,6.69,6.7,6.71,6.71,6.72,6.73,6.74,6.75,6.76,6.78,6.79,6.8,6.82,6.84,6.86,6.88,6.9,6.93,6.95,6.98,7.01,7.05,7.08,7.12,7.17,7.21,7.26,7.31,7.37,7.43,7.5,7.57,7.64,7.72,7.8,7.89,7.98,8.08,8.18,8.29,8.4,8.52,8.64,8.76,8.89,9.03,9.16,9.3,9.45,9.59,9.74,9.89,10.04,10.2,10.35,10.5,10.66,10.81,10.96,11.12,11.27,11.41,11.56,11.7,11.84,11.97,12.1,12.22,12.34,12.46,12.57,12.67,12.77,12.86,12.94,13.02,13.09,13.15,13.21,13.26,13.3,13.34,13.37,13.39,13.41,13.42,13.42,13.42,13.4,13.39,13.37,13.34,13.3,13.27,13.22,13.17,13.12,13.06,13,12.94,12.87,12.8,12.72,12.65,12.57,12.49,12.41,12.33,12.24,12.16,12.07,11.99,11.9,11.82,11.73,11.65,11.56,11.48,11.39,11.31,11.23,11.15,11.07,10.99,10.91,10.83,10.75,10.67,10.59,10.51,10.43,10.35,10.27,10.2,10.12,10.04,9.96,9.88,9.8,9.72,9.65,9.57,9.49,9.41,9.34,9.26,9.19,9.11,9.04,8.96,8.89,8.82,8.75,8.68,8.61,8.55,8.48,8.42,8.35,8.29,8.23,8.17,8.11,8.06,8,7.95,7.9,7.85,7.8,7.75,7.7,7.65,7.61,7.56,7.52,7.48,7.44,7.4,7.36,7.32,7.28,7.24,7.21,7.17,7.14,7.1,7.07,7.03,7,6.97,6.94,6.91,6.88,6.85,6.83,6.8,6.78,6.75,6.73,6.71,6.69,6.67,6.65,6.63,6.61,6.6,6.58,6.57,6.56,6.55,6.54,6.53,6.52,6.51,6.51,6.5,6.5,6.5,6.5,6.49,6.49,6.5,6.5,6.5,6.5,6.51,6.51,6.51,6.52,6.52,6.53,6.53,6.54,6.54,6.55,6.55,6.56,6.56,6.57,6.57,6.57,6.58,6.58,6.58,6.58,6.58,6.58,6.58,6.58,6.58,6.58,6.58,6.57,6.57,6.57,6.56,6.55,6.55,6.54,6.53,6.52,6.52,6.51,6.5,6.49,6.48,6.47,6.46,6.45,6.43,6.42,6.41,6.4,6.39,6.38,6.37,6.36,6.35,6.34,6.33,6.32,6.31,6.3,6.29,6.28,6.27,6.26,6.26,6.25,6.24,6.24,6.23,6.23,6.22,6.22,6.21,6.21,6.2,6.2,6.2,6.2,6.19,6.19,6.19,6.19,6.18,6.18,6.18,6.18,6.18,6.17,6.17,6.17,6.17,6.17,6.16,6.16,6.16,6.15,6.15,6.15,6.14,6.14,6.13,6.13,6.12,6.12,6.11,6.11,6.1,6.1,6.09,6.09,6.08,6.07,6.07,6.06,6.05,6.05,6.04,6.04,6.03,6.03,6.02,6.01,6.01,6,6,5.99,5.99,5.99,5.98,5.98,5.98,5.98,5.97,5.97,5.97,5.97,5.97,5.97,5.97,5.97,5.97,5.97,5.98,5.98,5.98,5.99,5.99,5.99,6,6,6.01,6.02,6.02,6.03,6.04,6.05,6.06,6.06,6.07,6.08,6.1,6.11,6.12,6.13,6.15,6.16,6.17,6.19,6.2,6.22,6.24,6.25,6.27,6.29,6.3,6.32,6.34,6.36,6.38,6.4,6.42,6.44,6.46,6.48,6.5,6.52,6.54,6.56,6.59,6.61,6.63,6.65,6.66,6.68,6.7,6.72,6.74,6.75,6.77,6.78,6.8,6.81,6.82,6.83,6.84,6.85,6.86,6.87,6.87,6.88,6.88,6.88,6.88,6.88,6.88,6.87,6.87,6.86,6.85,6.85,6.84,6.82,6.81,6.8,6.78,6.77,6.75,6.73,6.71,6.69,6.67,6.65,6.63,6.6,6.58,6.56,6.53,6.51,6.48,6.45,6.43,6.4,6.37,6.35,6.32,6.29,6.27,6.24,6.22,6.19,6.16,6.14,6.11,6.09,6.06,6.04,6.02,5.99,5.97,5.95,5.93,5.91,5.89,5.87,5.85,5.83,5.81,5.8,5.78,5.76,5.75,5.73,5.72,5.7,5.69,5.68,5.66,5.65,5.64,5.63,5.62,5.61,5.59,5.58,5.57,5.56,5.56,5.55,5.54,5.53,5.52,5.51,5.5,5.5,5.49,5.48,5.47,5.47,5.46,5.46,5.45,5.44,5.44,5.43,5.43,5.42,5.42,5.41,5.41,5.4,5.4,5.39,5.39,5.39,5.38,5.38,5.38,5.37,5.37,5.37,5.37,5.36,5.36,5.36,5.36,5.36,5.36,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.35,5.36,5.36,5.36,5.36,5.36,5.36,5.37,5.37,5.37,5.37,5.37,5.38,5.38,5.38,5.38,5.39,5.39,5.39,5.39,5.4,5.4,5.4,5.41,5.41,5.41,5.42,5.42,5.42,5.43,5.43,5.44,5.44,5.44,5.45,5.45,5.46,5.46,5.46,5.47,5.47,5.48,5.48,5.49,5.49,5.5,5.5,5.51,5.51,5.52,5.52,5.53,5.53,5.54,5.54,5.55,5.55,5.56,5.56,5.57,5.58,5.58,5.59,5.6,5.6,5.61,5.62,5.62,5.63,5.64,5.65,5.65,5.66,5.67,5.68,5.69,5.7,5.71,5.72,5.73,5.74,5.75,5.77,5.78,5.79,5.81,5.82,5.84,5.86,5.87,5.89,5.91,5.93,5.95,5.97,5.99,6.01,6.03,6.06,6.08,6.11,6.14,6.16,6.19,6.22,6.25,6.29,6.32,6.35,6.39,6.42,6.46,6.5,6.54,6.58,6.62,6.66,6.71,6.75,6.8,6.85,6.9,6.95,7,7.05,7.1,7.16,7.21,7.27,7.32,7.38,7.44,7.49,7.55,7.61,7.67,7.72,7.78,7.84,7.89,7.95,8,8.06,8.11,8.16,8.21,8.26,8.3,8.35,8.39,8.43,8.46,8.5,8.53,8.56,8.58,8.61,8.63,8.64,8.66,8.67,8.68,8.68,8.68,8.68,8.67,8.67,8.65,8.64,8.62,8.6,8.57];var line_lists=new Array();line_lists["HI Lyman Alpha"]=new Array(1215.67,0.416400,6.265e8);line_lists["HI Lyman Beta"]=new Array(1025.72,0.079120,1.897e8);line_lists["HI Lyman Gamma"]=new Array(972.54,0.029000,8.127e7);line_lists["HeI 0584.33A"]=new Array(584.33,0.285000,2.000e8);line_lists["HeI 0537.03A"]=new Array(537.03,0.075200,2.000e8);line_lists["HeI 0522.21A"]=new Array(522.21,0.030700,2.000e8);line_lists["CIII 0977.02A"]=new Array(977.02,0.757000,1.760e9);line_lists["CIV 1550.77A"]=new Array(1550.77,0.094750,2.628e8);line_lists["CIV 1548.19A"]=new Array(1548.19,0.189900,2.642e8);line_lists["OI 1302.17A"]=new Array(1302.17,0.04800000,5.650e8);line_lists["OIII 0702.33A"]=new Array(702.33,0.13700000,2.000e8);line_lists["OIV 0787.71A"]=new Array(787.71,0.11000000,2.000e8);line_lists["CaII 3968.47A"]=new Array(3968.47,0.311600,1.409e8);line_lists["CaII 3933.66A"]=new Array(3933.66,0.626700,1.444e8);line_lists["FeI 2463.40A"]=new Array(2463.40,0.053200,5.000e8);line_lists["FeII 1608.45A"]=new Array(1608.45,0.057700,2.740e8);line_lists["FeII 1144.94A"]=new Array(1144.94,0.083000,3.520e8);var nbins_=2000;var plot_range=80.;var z_=0.;var lambda_centre_rest=1215.67;var lambda_centre_obs=1215.67*(1+z_);var gamma_=6.265e8;var v_=47.9;var f_=0.41640;var N_=1e17;var min_lambda_obs=lambda_centre_obs-plot_range/2;var min_lambda_rest=min_lambda_obs/(1+z_);var max_lambda_obs=lambda_centre_obs+plot_range/2;var max_lambda_rest=max_lambda_obs/(1+z_);var data_y;var data_x=new Array(nbins_);var Sdata=[];var cline;var EW_width_min=-2.;var EW_width_max=2.;var EW_density_min=11.;var EW_density_max=22.;var velocity_indicator=1.;var velocity_spacing=180.;var velocity_list=[];var ball3;var dot3x;var EW_cal;var line3_dataset_x=[];var line3_dataset_y=[];var line3_dataset=[];var cline3;var nbins_2=1000;var lambda_centre_2_rest=1215.67;var lambda_centre_2_beta_rest=1025.7223;var lambda_centre_2_gamma_rest=972.5368;var lambda_centre_2_limit_rest=911.7633;var initialization=1;var rho_norm=17.9;var z_beta=8.1;var HI_alpha=2.1;var z_quasar=5.2;var flux_range_down=-0.1;var flux_range_up=15.;var data_x_2;var data_y_2;var data_y_2_quasar;var data_y_2_alpha;var data_y_2_beta;var data_y_2_gamma;var data_y_2_limit;var data_y_2_subtract;var data_y_2_subtract_alpha;var data_y_2_subtract_beta;var data_y_2_subtract_gamma;var data_y_2_subtract_limit;var Sdata_2=[];var Sdata_2_quasar=[];var Sdata_2_ani=[];var Sdata_2_alpha=[];var Sdata_2_beta=[];var Sdata_2_gamma=[];var Sdata_2_limit=[];var Sdata_2_subtract=[];var Sdata_2_subtract_alpha=[];var Sdata_2_subtract_beta=[];var Sdata_2_subtract_gamma=[];var Sdata_2_subtract_limit=[];var cline2_quasar;var cline2_line;var cline2_line_context;var cline2_subtract;var cline2_subtract_context;var cline2_subtract_alpha;var cline2_subtract_beta;var cline2_subtract_gamma;var cline2_subtract_limit;var cline2_single_alpha;var cline2_single_beta;var cline2_single_gamma;var cline2_single_limit;var cline2_alpha;var cline2_alpha_context;var cline2_beta;var cline2_beta_context;var cline2_gamma;var cline2_gamma_context;var cline2_limit;var cline2_limit_context;var text2_alpha="";var text2_beta="";var text2_gamma="";var text2_limit="";var alpha_on=1.;var beta_on=1.;var gamma_on=1.;var limit_on=1.;var stripping_on=0.;var quasar_on=1.;var run_animate;var animate_original=0.;var quasar_wavelength=new Array(quasar_rest_wavelength.length);for(var i=0;i<quasar_rest_wavelength.length;i++){quasar_wavelength[i]=quasar_rest_wavelength[i]*(1+z_quasar)}var min_lambda_2_obs=quasar_wavelength[0];var max_lambda_2_obs=quasar_wavelength[quasar_wavelength.length-1];var m=[60,60,60,60];var m2=[60,60,150,60];var m2b=[320,60,70,60];var m4=[30,30,30,30];var w=500-m[1]-m[3];var w2=800-m2[1]-m2[3];var w4=300-m[1]-m[3];var h=400-m[0]-m[2];var h2=440-m2[0]-m2[2];var h2b=440-m2b[0]-m2b[2];var h4=225-m[0]-m[2];var x=d3.scale.linear().domain([min_lambda_obs,max_lambda_obs]).range([0,w]);var x2=d3.scale.linear().domain([min_lambda_2_obs,max_lambda_2_obs]).range([0,w2]);var x2b=d3.scale.linear().domain([min_lambda_2_obs,max_lambda_2_obs]).range([0,w2]);var x3=d3.scale.linear().domain([EW_density_min,EW_density_max]).range([0,w]);var x4=d3.scale.linear().domain([min_lambda_2_obs,max_lambda_2_obs]).range([0,w4]);var y=d3.scale.linear().domain([-0.1,1.1]).range([h,0]);var y2=d3.scale.linear().domain([flux_range_down,flux_range_up]).range([h2,0]);var y2b=d3.scale.linear().domain([flux_range_down,flux_range_up]).range([h2b,0]);var y3=d3.scale.linear().domain([EW_width_min,EW_width_max]).range([h,0]);var y4=d3.scale.linear().domain([flux_range_down,flux_range_up]).range([h4,0]);var xAxis=d3.svg.axis().scale(x).ticks(5).orient("bottom");var xAxis2=d3.svg.axis().scale(x2).ticks(8).orient("bottom");var xAxis2b=d3.svg.axis().scale(x2b).ticks(8).orient("bottom");var xAxis3=d3.svg.axis().scale(x3).ticks(5).orient("bottom");var xAxis4=d3.svg.axis().scale(x4).ticks(4).orient("bottom");var yAxis=d3.svg.axis().scale(y).ticks(5).orient("left");var yAxis2=d3.svg.axis().scale(y2).ticks(8).orient("left");var yAxis2b=d3.svg.axis().scale(y2b).ticks(3).orient("left");var yAxis3=d3.svg.axis().scale(y3).ticks(5).orient("left");var yAxis4=d3.svg.axis().scale(y4).ticks(4).orient("left");var line=d3.svg.line().x(function(d){return x(d[0])}).y(function(d){return y(d[1])});var line2=d3.svg.line().x(function(d){return x2(d[0])}).y(function(d){return y2(d[1])});var line2b=d3.svg.line().x(function(d){return x2b(d[0])}).y(function(d){return y2b(d[1])});var line3=d3.svg.line().x(function(d){return x3(d[0])}).y(function(d){return y3(d[1])});var line4=d3.svg.line().x(function(d){return x4(d[0])}).y(function(d){return y4(d[1])});function make_x_axis(){return d3.svg.axis().scale(x).orient("bottom").ticks(6)};function make_y_axis(){return d3.svg.axis().scale(y).orient("left").ticks(8)};var graph=d3.select("#column-left").append("svg").attr("width",w+m[1]+m[3]).attr("height",h+m[0]+m[2]).append("g").attr("transform","translate("+m[3]+","+m[0]+")");var graph3=d3.select("#column-right").append("svg").attr("width",w+m[1]+m[3]).attr("height",h+m[0]+m[2]).append("g").attr("transform","translate("+m[3]+","+m[0]+")");var graph4=d3.select("#multiple-plot-4").append("svg").attr("width",w4+m4[1]+m4[3]).attr("height",h4+m4[0]+m4[2]).append("g").attr("transform","translate("+m4[3]+","+m4[0]+")");var graph5=d3.select("#multiple-plot-5").append("svg").attr("width",w4+m4[1]+m4[3]).attr("height",h4+m4[0]+m4[2]).append("g").attr("transform","translate("+m4[3]+","+m4[0]+")");var graph6=d3.select("#multiple-plot-6").append("svg").attr("width",w4+m4[1]+m4[3]).attr("height",h4+m4[0]+m4[2]).append("g").attr("transform","translate("+m4[3]+","+m4[0]+")");var graph7=d3.select("#multiple-plot-7").append("svg").attr("width",w4+m4[1]+m4[3]).attr("height",h4+m4[0]+m4[2]).append("g").attr("transform","translate("+m4[3]+","+m4[0]+")");var title1;var title3;var title4;var title5;var title6;var title7;var brush=d3.svg.brush().x(x2b).on("brush",brushed);function brushed(){brush_temp=new Array(2);for(var i=0;i<brush.extent().length;i++){brush_temp[i]=brush.extent()[i]*(1.+z_quasar)/(1.+5.2)}x2.domain(brush.empty()?x2b.domain():brush_temp);focus.selectAll("path").attr("class","line").attr("d",line2);focus.select(".x.axis").call(xAxis2);focus.select(".y.axis").call(yAxis2)};var graph2=d3.select("#multiple-plot").append("svg").attr("width",w2+m2[1]+m2[3]).attr("height",h2+m2[0]+m2[2]);graph2.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",w2).attr("height",h2);var focus=graph2.append("g").attr("transform","translate("+m2[3]+","+m2[0]+")");var context=graph2.append("g").attr("transform","translate("+m2b[3]+","+m2b[0]+")");function draw_delimiter(indicator){if(cline2_alpha){cline2_alpha.remove()};if(cline2_beta){cline2_beta.remove()};if(cline2_gamma){cline2_gamma.remove()};if(cline2_limit){cline2_limit.remove()};if(cline2_alpha_context){cline2_alpha_context.remove()};if(cline2_beta_context){cline2_beta_context.remove()};if(cline2_gamma_context){cline2_gamma_context.remove()};if(cline2_limit_context){cline2_limit_context.remove()};if(text2_alpha){text2_alpha.remove()};if(text2_beta){text2_beta.remove()};if(text2_gamma){text2_gamma.remove()};if(text2_limit){text2_limit.remove()};if(indicator=="1"){cline2_alpha=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_alpha").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_alpha_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_alpha").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_beta=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_beta_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_beta_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_beta").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_beta_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_beta_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_beta_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_beta").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_gamma=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_gamma_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_gamma_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_gamma").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_gamma_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_gamma_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_gamma_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_gamma").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_limit=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_limit_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_limit_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_limit").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_limit_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_limit_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_limit_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_limit").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");text2_alpha=focus.append("text").attr("x",6).attr("dy",15);text2_alpha.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_alpha").attr("font-size","15px").text("Lyman Alpha");text2_beta=focus.append("text").attr("x",6).attr("dy",15);text2_beta.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_beta").attr("font-size","15px").text("Lyman Beta");text2_gamma=focus.append("text").attr("x",6).attr("dy",15);text2_gamma.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_gamma").attr("font-size","15px").text("Lyman Gamma");text2_limit=focus.append("text").attr("x",6).attr("dy",15);text2_limit.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_limit").attr("font-size","15px").text("Lyman Limit")};if(indicator=="1s"){cline2_alpha_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_alpha").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_beta_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_beta_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_beta_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_beta").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_gamma_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_gamma_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_gamma_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_gamma").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5");cline2_limit_context=context.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_limit_rest*(1+z_quasar),flux_range_up],[lambda_centre_2_limit_rest*(1+z_quasar),flux_range_down]]]).attr("class","line").attr("d",line2b).attr("id","path_limit").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","5")};if(indicator=="2"){cline2_alpha=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_rest,flux_range_up],[lambda_centre_2_rest,flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_alpha").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","2");cline2_beta=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_beta_rest,flux_range_up],[lambda_centre_2_beta_rest,flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_beta").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","2");cline2_gamma=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_gamma_rest,flux_range_up],[lambda_centre_2_gamma_rest,flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_gamma").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","2");cline2_limit=focus.append("path").attr("clip-path","url(#clip)").data([[[lambda_centre_2_limit_rest,flux_range_up],[lambda_centre_2_limit_rest,flux_range_down]]]).attr("class","line").attr("d",line2).attr("id","path_limit").style("stroke","white").style("stroke-dasharray",("3, 3")).style("stroke-width","2");text2_alpha=focus.append("text").attr("x",6).attr("dy",15);text2_alpha.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_alpha").attr("font-size","15px").text("Lyman Alpha");text2_beta=focus.append("text").attr("x",6).attr("dy",15);text2_beta.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_beta").attr("font-size","15px").text("Lyman Beta");text2_gamma=focus.append("text").attr("x",6).attr("dy",15);text2_gamma.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_gamma").attr("font-size","15px").text("Lyman Gamma");text2_limit=focus.append("text").attr("x",6).attr("dy",15);text2_limit.append("textPath").attr("clip-path","url(#clip)").attr("fill","white").attr("xlink:href","#path_limit").attr("font-size","15px").text("Lyman Limit")}};function replot_axis(indicator){if(indicator==1){graph.append("g").attr("class","x axis").attr("font-size","18px").attr("transform","translate(0,"+h+")").call(xAxis).append("text").attr("y",45.).attr("x",100.).attr("font-size","18px").text("Wavelength (Angstrom)");graph.append("g").attr("class","y axis").attr("font-size","18px").attr("transform","translate(0,0)").call(yAxis).append("text").attr("y",-20.).attr("x",-40.).attr("font-size","18px").text("Absorption");graph.append("g").attr("class","grid").attr("transform","translate(0,"+h+")").call(make_x_axis().tickSize(-h,0,0).tickFormat(""));graph.append("g").attr("class","grid").call(make_y_axis().tickSize(-w,0,0).tickFormat(""));title=graph.append("text").attr("class","title").attr("dy","-0.80em").attr("dx","14.0em").text("Spectral Profile")};if(indicator==2){focus.append("g").attr("class","x axis").attr("font-size","18px").attr("transform","translate(0,"+h2+")").call(xAxis2).append("text").attr("y",45.).attr("x",100.).attr("font-size","18px");focus.append("g").attr("class","y axis").attr("font-size","18px").attr("transform","translate(0,0)").call(yAxis2).append("text").attr("y",-20.).attr("x",-40.).attr("font-size","18px").text("Flux");title2=focus.append("text").attr("class","title").attr("dy","-0.80em").attr("dx","25.0em").text("Lyman Alpha Forest");context.append("g").attr("class","x axis").attr("font-size","18px").attr("transform","translate(0,"+h2b+")").call(xAxis2b).append("text").attr("y",50.).attr("x",230.).attr("font-size","18px").text("Wavelength (Angstrom)");context.append("g").attr("class","y axis").attr("font-size","18px").attr("transform","translate(0,0)").call(yAxis2b).append("text").attr("y",-20.).attr("x",-40.).attr("font-size","18px");context.append("g").attr("class","x brush").call(brush).selectAll("rect").attr("y",-6).attr("height",h2b+7).attr("fill","white").attr("fill-opacity",0.3)};if(indicator=="2s"){focus.append("g").attr("class","x axis").attr("font-size","18px").attr("transform","translate(0,"+h2+")").call(xAxis2).append("text").attr("y",45.).attr("x",100.).attr("font-size","18px");focus.append("g").attr("class","y axis").attr("font-size","18px").attr("transform","translate(0,0)").call(yAxis2).append("text").attr("y",-20.).attr("x",-40.).attr("font-size","18px").text("Flux");title2=focus.append("text").attr("class","title").attr("dy","-0.80em").attr("dx","25.0em").text("Lyman Alpha Forest")};if(indicator==3){graph3.append("g").attr("class","x axis").attr("font-size","18px").attr("transform","translate(0,"+h+")").call(xAxis3).append("text").attr("y",45.).attr("x",110.).attr("font-size","18px").text("Log Column Density");graph3.append("g").attr("class","y axis").attr("font-size","18px").attr("transform","translate(0,0)").call(yAxis3).append("text").attr("y",-20.).attr("x",-40.).attr("font-size","18px").text("Log Equivalent Width");title3=graph3.append("text").attr("class","title").attr("dy","-0.80em").attr("dx","13.0em").text("Curve of Growth")};if(indicator==4){graph4.append("g").attr("class","x axis").attr("font-size","12px").attr("transform","translate(0,"+h4+")").call(xAxis4);graph4.append("g").attr("class","y axis").attr("font-size","12px").attr("transform","translate(0,0)").call(yAxis4);title4=graph4.append("text").attr("class","title2").attr("dy","-0.50em").attr("dx","6.0em").text("Lyman Alpha");graph5.append("g").attr("class","x axis").attr("font-size","12px").attr("transform","translate(0,"+h4+")").call(xAxis4);graph5.append("g").attr("class","y axis").attr("font-size","12px").attr("transform","translate(0,0)").call(yAxis4);title5=graph5.append("text").attr("class","title2").attr("dy","-0.50em").attr("dx","6.0em").text("Lyman Beta");graph6.append("g").attr("class","x axis").attr("font-size","12px").attr("transform","translate(0,"+h4+")").call(xAxis4);graph6.append("g").attr("class","y axis").attr("font-size","12px").attr("transform","translate(0,0)").call(yAxis4);title6=graph6.append("text").attr("class","title2").attr("dy","-0.50em").attr("dx","6.0em").text("Lyman Gamma");graph7.append("g").attr("class","x axis").attr("font-size","12px").attr("transform","translate(0,"+h4+")").call(xAxis4);graph7.append("g").attr("class","y axis").attr("font-size","12px").attr("transform","translate(0,0)").call(yAxis4);title7=graph7.append("text").attr("class","title2").attr("dy","-0.50em").attr("dx","6.0em").text("Lyman Limit")}};function rescale_axis(indicator){if(indicator=="1x"){x=d3.scale.linear().domain([min_lambda_obs,max_lambda_obs]).range([0,w]);xAxis=d3.svg.axis().scale(x).ticks(5).orient("bottom");var t=graph.transition().duration(750);t.select(".x.axis").call(xAxis)};if(indicator=="2x"){x2=d3.scale.linear().domain([min_lambda_2_obs,max_lambda_2_obs]).range([0,w2]);xAxis2=d3.svg.axis().scale(x2).ticks(8).orient("bottom");var t=focus.transition().duration(750);t.select(".x.axis").call(xAxis2);x2b=d3.scale.linear().domain([min_lambda_2_obs,max_lambda_2_obs]).range([0,w2]);xAxis2b=d3.svg.axis().scale(x2b).ticks(8).orient("bottom");var tb=context.transition().duration(750);tb.select(".x.axis").call(xAxis2b)};if(indicator=="2y"){y2=d3.scale.linear().domain([flux_range_down,flux_range_up]).range([h2,0]);yAxis2=d3.svg.axis().scale(y2).ticks(8).orient("left");var ty=focus.transition().duration(750);ty.select(".y.axis").call(yAxis2);y2b=d3.scale.linear().domain([flux_range_down,flux_range_up]).range([h2b,0]);yAxis2b=d3.svg.axis().scale(y2b).ticks(3).orient("left");var ty2=context.transition().duration(750);ty2.select(".y.axis").call(yAxis2b)};if(indicator=="4x"){x4=d3.scale.linear().domain([min_lambda_2_obs,max_lambda_2_obs]).range([0,w4]);xAxis4=d3.svg.axis().scale(x4).ticks(4).orient("bottom");var t=graph4.transition().duration(750);t.select(".x.axis").call(xAxis4);var t=graph5.transition().duration(750);t.select(".x.axis").call(xAxis4);var t=graph6.transition().duration(750);t.select(".x.axis").call(xAxis4);var t=graph7.transition().duration(750);t.select(".x.axis").call(xAxis4)};if(indicator=="4y"){y4=d3.scale.linear().domain([flux_range_down,flux_range_up]).range([h4,0]);yAxis4=d3.svg.axis().scale(y4).ticks(8).orient("left");var ty=graph4.transition().duration(750);ty.select(".y.axis").call(yAxis4);var ty=graph5.transition().duration(750);ty.select(".y.axis").call(yAxis4);var ty=graph6.transition().duration(750);ty.select(".y.axis").call(yAxis4);var ty=graph7.transition().duration(750);ty.select(".y.axis").call(yAxis4)}};$(function(){$("#density-range").slider({orientation:"horizontal",range:"min",min:10,max:22,step:0.1,value:Math.log(N_)/Math.LN10,slide:function(event,ui){$("#density-range").val(""+ui.value);N_=Math.pow(10,ui.value);$("#density").val(""+Math.round((Math.pow(10,ui.value-Math.ceil(ui.value)+1))*Math.pow(10,1))/Math.pow(10,1)+"e"+(Math.ceil(ui.value)-1).toString()+" atoms/cm\262");update();if(velocity_indicator==1.){if(graph3.selectAll("text")){graph3.selectAll("text").remove()};if(graph3.selectAll("line")){graph3.selectAll("line").remove()};replot_axis(3);replot_dispersion_indicator("yes")};velocity_indicator=0.;calculate_curve_of_growth("red","no")}});$("#density-range").val(+$("#density-range").slider("values"));temp=Math.log(N_)/Math.LN10;$("#density").val(""+Math.round((Math.pow(10,temp-Math.ceil(temp)+1))*Math.pow(10,1))/Math.pow(10,1)+"e"+(Math.ceil(temp)-1).toString()+" atoms/cm\262")});$(function(){$("#dispersion-range").slider({orientation:"horizontal",range:"min",min:10.,max:200.,step:0.1,value:v_,slide:function(event,ui){$("#dispersion-range").val(""+ui.value);$("#dispersion").val(""+ui.value+" km/s");v_=ui.value;update();if(velocity_indicator==0){velocity_indicator=1;graph3.append("path").data([line3_dataset]).attr("class","line").attr("d",line3).attr("id","path1").style("stroke","#8ae234");if(graph3.selectAll("text")){graph3.selectAll("text").remove()};if(graph3.selectAll("line")){graph3.selectAll("line").remove()};replot_axis(3);replot_dispersion_indicator("no")};if(line3_dataset){line3_dataset=[]};if(line3_dataset_x){line3_dataset_x=[]};if(line3_dataset_y){line3_dataset_y=[]};if(cline3){cline3.remove()}calculate_curve_of_growth("white","yes")}});$("#dispersion-range").val(+$("#dispersion-range").slider("values"));$("#dispersion").val(""+v_+" km/s")});$(function(){$("#redshift-range").slider({orientation:"horizontal",range:"min",min:0.,max:3.,step:0.05,value:z_,slide:function(event,ui){$("#redshift-range").val(""+ui.value);$("#redshift").val(""+ui.value);z_=ui.value;lambda_centre_obs=lambda_centre_rest*(1+z_);min_lambda_obs=lambda_centre_obs-plot_range/2;max_lambda_obs=lambda_centre_obs+plot_range/2;min_lambda_rest=min_lambda_obs/(1+z_);max_lambda_rest=max_lambda_obs/(1+z_);rescale_axis("1x");update();update_EW_plot()}});$("#redshift-range").val(+$("#redshift-range").slider("values"));$("#redshift").val(""+z_)});$(function(){$("#plot-range").slider({orientation:"horizontal",range:"min",min:4,max:200,step:0.1,value:plot_range,slide:function(event,ui){$("#plot-range").val(""+ui.value);$("#plot-val").val(""+ui.value+" Angstrom");plot_range=ui.value;min_lambda_obs=lambda_centre_obs-plot_range/2;max_lambda_obs=lambda_centre_obs+plot_range/2;min_lambda_rest=min_lambda_obs/(1+z_);max_lambda_rest=max_lambda_obs/(1+z_);rescale_axis("1x");update()}});$("#plot-range").val(+$("#plot-range").slider("values"));$("#plot-val").val(""+plot_range+" Angstrom")});$(function(){$("#clump_norm").slider({orientation:"horizontal",range:"min",min:16.1,max:19.7,step:0.3,value:rho_norm,stop:function(event,ui){$("#clump_norm").val(""+ui.value);rho_norm=ui.value;$("#clump_norm_val").val(""+Math.round((Math.pow(10,ui.value-Math.ceil(ui.value)+1))*Math.pow(10,1))/Math.pow(10,1)+"e"+(Math.ceil(ui.value)-1).toString()+" atoms/cm\262");update2()}});$("#clump_norm").val(+$("#clump_norm").slider("values"));temp=rho_norm;$("#clump_norm_val").val(""+Math.round((Math.pow(10,temp-Math.ceil(temp)+1))*Math.pow(10,1))/Math.pow(10,1)+"e"+(Math.ceil(temp)-1).toString()+" atoms/cm\262")});$(function(){$("#z_power").slider({orientation:"horizontal",range:"min",min:0.1,max:40.1,step:4.,value:z_beta,stop:function(event,ui){$("#z_power").val(""+ui.value);$("#z_power_val").val(""+ui.value+"");z_beta=ui.value;update2()}});$("#z_power").val(+$("#z_power").slider("values"));$("#z_power_val").val(""+z_beta+"")});$(function(){$("#HI_power").slider({orientation:"horizontal",range:"min",min:0.1,max:4.1,step:0.4,value:HI_alpha,stop:function(event,ui){$("#HI_power").val(""+ui.value);$("#HI_power_val").val(""+ui.value+"");HI_alpha=ui.value;update2()}});$("#HI_power").val(+$("#HI_power").slider("values"));$("#HI_power_val").val(""+HI_alpha+"")});$(function(){$("#zquasar-range").slider({orientation:"horizontal",range:"min",min:2.,max:10.,step:0.8,value:z_quasar,stop:function(event,ui){$("#zquasar-range").val(""+ui.value);$("#zquasar_val").val(""+ui.value);z_quasar=ui.value;z_2_max=ui.value;quasar_wavelength=new Array(quasar_rest_wavelength.length);for(var i=0;i<quasar_rest_wavelength.length;i++){quasar_wavelength[i]=quasar_rest_wavelength[i]*(1+z_quasar)};min_lambda_2_obs=quasar_wavelength[0];max_lambda_2_obs=quasar_wavelength[quasar_wavelength.length-1];update2();rescale_axis("2x");rescale_axis("4x");setTimeout(function(){brushed()},800)}});$("#zquasar-range").val(+$("#zquasar-range").slider("values"));$("#zquasar_val").val(""+z_quasar)});function update(){if(Sdata){Sdata=[]};if(cline){cline.remove()};EW_cal_temp=0.;data_y=absorption_line(nbins_,min_lambda_rest,max_lambda_rest,lambda_centre_rest,gamma_,v_,f_,N_);for(var i=0;i<data_y.length;i++){data_y[i]=Math.exp(-data_y[i])};delta_lambda_obs=(max_lambda_obs-min_lambda_obs)/nbins_;data_x=new Array(nbins_);for(var i=0;i<data_x.length;i++){data_x[i]=delta_lambda_obs*i+min_lambda_obs};for(var i=0;i<data_x.length;i++){if(isNaN(data_y[i])){data_y[i]=data_y[i-1]};Sdata.push([data_x[i],data_y[i]])};cline=graph.append("path").data([Sdata]).attr("class","line").attr("d",line);for(var i=0;i<data_y.length;i++){EW_cal_temp=EW_cal_temp+(1-data_y[i])*delta_lambda_obs};EW_cal=Math.log(EW_cal_temp)/Math.LN10;dot3x=Math.log(N_)/Math.LN10};function voigt(nbins,min_lambda,max_lambda,lambda_centre,gaussian_width,lorentz_width){delta_lambda=(max_lambda-min_lambda)/nbins;a=lorentz_width/gaussian_width;result=new Array(nbins);for(var i=0;i<nbins;i++){lambda_c=delta_lambda*i+min_lambda;u=(lambda_c-lambda_centre)/gaussian_width;if(u<0){u=-u};usq=u*u;if(u>19.99){result[i]=((a/(1.772453851*usq)*(1.0+1.5/usq+3.75/(usq*usq)-a*a/usq*(1.0+5.0/usq+26.25/(usq*usq)))))}else{DU=0.01;emusq=Math.exp(-usq);ud=u/DU;n1=Math.round(ud);n2=n1+1;dif1=n2-ud;dif2=ud-n1;result[i]=((emusq+a*(h1[n1]*dif1+h1[n2]*dif2+a*((1.0-2.0*usq)*emusq+a*(h1[n1]*dif1+h1[n2]*dif2+a*(0.5-2.0*usq+2.0/3.0*usq*usq)*emusq)))))}};return result};function absorption_line(nbins,min_lambda,max_lambda,lambda_centre,gamma,v,f,N){l_width=gamma*(lambda_centre/1.e5)*(lambda_centre/1.e5)/(4*3.141592*3.e8);gaussian_width=lambda_centre*v/3.e5;result=voigt(nbins,min_lambda,max_lambda,lambda_centre,gaussian_width,l_width);factor=1.4974e-15*lambda_centre*f*N/v;for(var k=0;k<nbins;k++){result[k]=result[k]*factor};return result};function update_element(line_name){line_list=line_lists[line_name];lambda_centre_rest=line_list[0];f_=line_list[1];gamma_=line_list[2];lambda_centre_obs=lambda_centre_rest*(1+z_);min_lambda_obs=lambda_centre_obs-plot_range/2;min_lambda_rest=min_lambda_obs/(1+z_);max_lambda_obs=lambda_centre_obs+plot_range/2;max_lambda_rest=max_lambda_obs/(1+z_);x=d3.scale.linear().domain([min_lambda_obs,max_lambda_obs]).range([0,w]);xAxis=d3.svg.axis().scale(x).ticks(5).orient("bottom");var t=graph.transition().duration(750);t.select(".x.axis").call(xAxis);update();update_EW_plot();if(line3_dataset){line3_dataset=[]};if(line3_dataset_x){line3_dataset_x=[]};if(line3_dataset_y){line3_dataset_y=[]};calculate_curve_of_growth("white","yes")};function calculate_curve_of_growth(ball_color,just_ball){if(just_ball=="no"){if((line3_dataset_x.length==0)&&(data_y[0]>0.95)&&(data_y[data_y.length-1]>0.95)){line3_dataset_x.push(dot3x);line3_dataset_y.push(EW_cal)};if(!line3_dataset_x.indexOf(dot3x)>-1){if((dot3x>line3_dataset_x[line3_dataset_x.length-1])&&(data_y[0]>0.95)&&(data_y[data_y.length-1]>0.95)){line3_dataset_x.push(dot3x);line3_dataset_y.push(EW_cal);if(cline3){cline3.remove()}};if((dot3x<line3_dataset_x[0])&&(data_y[0]>0.95)&&(data_y[data_y.length-1]>0.95)){line3_dataset_x=line3_dataset_x.reverse();line3_dataset_y=line3_dataset_y.reverse();line3_dataset_x.push(dot3x);line3_dataset_y.push(EW_cal);line3_dataset_x=line3_dataset_x.reverse();line3_dataset_y=line3_dataset_y.reverse();if(cline3){cline3.remove()}};if(line3_dataset){line3_dataset=[]};for(var i=0;i<line3_dataset_x.length;i++){if((line3_dataset_y[i]>-2)){line3_dataset.push([line3_dataset_x[i],line3_dataset_y[i]])}};if(cline3){cline3.remove()};cline3=graph3.append("path").data([line3_dataset]).attr("class","line").attr("d",line3).style("stroke","white")}};if((EW_cal>-2)&&(data_y[0]>0.95)&&(data_y[data_y.length-1]>0.95)){if(ball3){ball3.remove()};ball3=graph3.append("circle").data([[dot3x,EW_cal]]).attr("cx",function(d){return x3(d[0])}).attr("cy",function(d){return y3(d[1])}).attr("r",7).style("fill",ball_color)}};function update_EW_plot(){if(cline3){cline3.remove()};if(line3_dataset){line3_dataset=[]};if(line3_dataset_x){line3_dataset_x=[]};if(line3_dataset_y){line3_dataset_y=[]};calculate_curve_of_growth("white","yes");if(velocity_list){velocity_list=[]};velocity_indicator=1.;velocity_spacing=250.;if(graph3.selectAll("path")){graph3.selectAll("path").remove()};if(graph3.selectAll("text")){graph3.selectAll("text").remove()};if(graph3.selectAll("line")){graph3.selectAll("line").remove()};replot_axis(3)};function replot_dispersion_indicator(current_or_not){velocity_list=velocity_list.sort(function(a,b){return a-b});for(var i=0;i<velocity_list.length;i++){graph3.append("text").attr("x",280).attr("dy",velocity_spacing).attr("fill","#8ae234").attr("font-size","15px").text("(Curve "+(velocity_list.length-i)+") "+velocity_list[i]+" km/s");velocity_spacing=velocity_spacing-20.};if(current_or_not=="yes"){graph3.append("text").attr("x",280).attr("dy",velocity_spacing).attr("fill","white").attr("font-size","15px").text("(Current): "+v_+" km/s");velocity_spacing=velocity_spacing-20.};graph3.append("text").attr("x",280).attr("dy",velocity_spacing).attr("fill","white").attr("font-size","15px").text("Velocity Dispersion:");if(current_or_not=="yes"){velocity_list.push(v_)};velocity_spacing=250.};function update2(){if(initialization==0){$("#clump_norm").slider("disable");$("#z_power").slider("disable");$("#HI_power").slider("disable");$("#zquasar-range").slider("disable")};if(document.getElementById("alpha_mode").checked==false){document.getElementById("alpha_mode").checked=true;alpha_on=1.};if(document.getElementById("beta_mode").checked==false){document.getElementById("beta_mode").checked=true;beta_on=1.};if(document.getElementById("gamma_mode").checked==false){document.getElementById("gamma_mode").checked=true;gamma_on=1.};if(document.getElementById("limit_mode").checked==false){document.getElementById("limit_mode").checked=true;limit_on=1.};if(document.getElementById("quasar_check").checked==false){document.getElementById("quasar_check").checked=true;quasar_on=1.};if(Sdata_2){Sdata_2=[]};if(Sdata_2_quasar){Sdata_2_quasar=[]};if(Sdata_2_alpha){Sdata_2_alpha=[]};if(Sdata_2_beta){Sdata_2_beta=[]};if(Sdata_2_gamma){Sdata_2_gamma=[]};if(Sdata_2_limit){Sdata_2_limit=[]};if(Sdata_2_subtract){Sdata_2_subtract=[]};if(Sdata_2_subtract_alpha){Sdata_2_subtract_alpha=[]};if(Sdata_2_subtract_beta){Sdata_2_subtract_beta=[]};if(Sdata_2_subtract_gamma){Sdata_2_subtract_gamma=[]};if(Sdata_2_subtract_limit){Sdata_2_subtract_limit=[]};if(data_x_2){data_x_2=[]};if(data_y_2){data_y_2=[]};if(data_y_2_quasar){data_y_2_quasar=[]};if(data_y_2_alpha){data_y_2_alpha=[]};if(data_y_2_beta){data_y_2_beta=[]};if(data_y_2_gamma){data_y_2_gamma=[]};if(data_y_2_limit){data_y_2_limit=[]};if(data_y_2_subtract){data_y_2_subtract=[]};if(data_y_2_subtract_alpha){data_y_2_subtract_alpha=[]};if(data_y_2_subtract_beta){data_y_2_subtract_beta=[]};if(data_y_2_subtract_gamma){data_y_2_subtract_gamma=[]};if(data_y_2_subtract_limit){data_y_2_subtract_limit=[]};CacheData.getData(z_quasar,rho_norm,z_beta,HI_alpha,function(data){if(data){update2_part2();$("#clump_norm").slider("enable");$("#z_power").slider("enable");$("#HI_power").slider("enable");$("#zquasar-range").slider("enable")}})};function update2_part2(){z_quasar=z_quasar[0];if(cline2_line){cline2_line.remove()};if(cline2_line_context){cline2_line_context.remove()};if(cline2_single_alpha){cline2_single_alpha.remove()};if(cline2_single_beta){cline2_single_beta.remove()};if(cline2_single_gamma){cline2_single_gamma.remove()};if(cline2_single_limit){cline2_single_limit.remove()};if(cline2_subtract){cline2_subtract.remove()}if(cline2_subtract_context){cline2_subtract_context.remove()};if(cline2_subtract_alpha){cline2_subtract_alpha.remove()};if(cline2_subtract_beta){cline2_subtract_beta.remove()};if(cline2_subtract_gamma){cline2_subtract_gamma.remove()};if(cline2_subtract_limit){cline2_subtract_limit.remove()};if(cline2_quasar){cline2_quasar.remove()};for(var i=0;i<data_y_2.length;i++){Sdata_2.push([data_x_2[i],data_y_2[i]]);Sdata_2_quasar.push([data_x_2[i],data_y_2_quasar[i]]);Sdata_2_subtract.push([data_x_2[i],data_y_2_subtract[i]]);Sdata_2_alpha.push([data_x_2[i],data_y_2_alpha[i]]);Sdata_2_subtract_alpha.push([data_x_2[i],data_y_2_subtract_alpha[i]]);Sdata_2_beta.push([data_x_2[i],data_y_2_beta[i]]);Sdata_2_subtract_beta.push([data_x_2[i],data_y_2_subtract_beta[i]]);Sdata_2_gamma.push([data_x_2[i],data_y_2_gamma[i]]);Sdata_2_subtract_gamma.push([data_x_2[i],data_y_2_subtract_gamma[i]]);Sdata_2_limit.push([data_x_2[i],data_y_2_limit[i]]);Sdata_2_subtract_limit.push([data_x_2[i],data_y_2_subtract_limit[i]])};forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="line"){cline2_line=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2]).attr("class","line").attr("d",line2);cline2_line_context=context.append("path").data([Sdata_2]).attr("class","line").attr("d",line2b);cline2_single_alpha=graph4.append("path").data([Sdata_2_alpha]).attr("class","line").attr("d",line4).style("stroke","#b5cf6b").style("stroke-width","0.5");cline2_single_beta=graph5.append("path").data([Sdata_2_beta]).attr("class","line").attr("d",line4).style("stroke","#fd8d3c").style("stroke-width","0.5");cline2_single_gamma=graph6.append("path").data([Sdata_2_gamma]).attr("class","line").attr("d",line4).style("stroke","#aec7e8").style("stroke-width","0.5");cline2_single_limit=graph7.append("path").data([Sdata_2_limit]).attr("class","line").attr("d",line4).style("stroke","white").style("stroke-width","0.5")};if(forest_mode=="quasar"){cline2_subtract=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_subtract]).attr("class","line").attr("d",line2);cline2_subtract_context=context.append("path").data([Sdata_2_subtract]).attr("class","line").attr("d",line2b);cline2_subtract_alpha=graph4.append("path").data([Sdata_2_subtract_alpha]).attr("class","line").attr("d",line4).style("stroke","#b5cf6b").style("stroke-width","0.5");cline2_subtract_beta=graph5.append("path").data([Sdata_2_subtract_beta]).attr("class","line").attr("d",line4).style("stroke","#fd8d3c").style("stroke-width","0.5");cline2_subtract_gamma=graph6.append("path").data([Sdata_2_subtract_gamma]).attr("class","line").attr("d",line4).style("stroke","#aec7e8").style("stroke-width","0.5");cline2_subtract_limit=graph7.append("path").data([Sdata_2_subtract_limit]).attr("class","line").attr("d",line4).style("stroke","white").style("stroke-width","0.5");if(quasar_on==1){cline2_quasar=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_quasar]).attr("class","line").attr("d",line2).style("stroke","red").style("stroke-dasharray",("3, 3")).style("stroke-width","2")}};if(stripping_on==0){draw_delimiter(1)};if(stripping_on==1){draw_delimiter("1s")}};function original_quasar_check(){if(quasar_on==1){if(cline2_quasar){cline2_quasar.remove()};quasar_on=0}else{cline2_quasar=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_quasar]).attr("class","line").attr("d",line2).style("stroke","red").style("stroke-dasharray",("3, 3")).style("stroke-width","2");quasar_on=1}};function forest_mode_change(){forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="line"){flux_range_up=2.0;rescale_axis("2y");rescale_axis("4y");if(cline2_quasar){cline2_quasar.remove()};if(cline2_subtract){cline2_subtract.remove()};if(cline2_subtract_context){cline2_subtract_context.remove()};cline2_line=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2]).attr("class","line").attr("d",line2);cline2_line_context=context.append("path").data([Sdata_2]).attr("class","line").attr("d",line2b);if(stripping_on==0){draw_delimiter(1)};if(cline2_subtract_alpha){cline2_subtract_alpha.remove()};if(alpha_on==1){cline2_single_alpha=graph4.append("path").data([Sdata_2_alpha]).attr("class","line").attr("d",line4).style("stroke","#b5cf6b").style("stroke-width","0.5")};if(cline2_subtract_beta){cline2_subtract_beta.remove()};if(beta_on==1){cline2_single_beta=graph5.append("path").data([Sdata_2_beta]).attr("class","line").attr("d",line4).style("stroke","#fd8d3c").style("stroke-width","0.5")};if(cline2_subtract_gamma){cline2_subtract_gamma.remove()};if(gamma_on==1){cline2_single_gamma=graph6.append("path").data([Sdata_2_gamma]).attr("class","line").attr("d",line4).style("stroke","#aec7e8").style("stroke-width","0.5")};if(cline2_subtract_limit){cline2_subtract_limit.remove()};if(limit_on==1){cline2_single_limit=graph7.append("path").data([Sdata_2_limit]).attr("class","line").attr("d",line4).style("stroke","white").style("stroke-width","0.5")}};if(forest_mode=="quasar"){flux_range_up=15.;rescale_axis("2y");rescale_axis("4y");if(cline2_quasar){cline2_quasar.remove()};if(cline2_line){cline2_line.remove()};if(cline2_line_context){cline2_line_context.remove()};cline2_subtract=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_subtract]).attr("class","line").attr("d",line2);cline2_subtract_context=context.append("path").data([Sdata_2_subtract]).attr("class","line").attr("d",line2b);if(quasar_on==1){cline2_quasar=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_quasar]).attr("class","line").attr("d",line2).style("stroke","red").style("stroke-dasharray",("3, 3")).style("stroke-width","2")};if(stripping_on==0){draw_delimiter(1)};if(cline2_single_alpha){cline2_single_alpha.remove()};if(alpha_on==1){cline2_subtract_alpha=graph4.append("path").data([Sdata_2_subtract_alpha]).attr("class","line").attr("d",line4).style("stroke","#b5cf6b").style("stroke-width","0.5")};if(cline2_single_beta){cline2_single_beta.remove()};if(beta_on==1){cline2_subtract_beta=graph5.append("path").data([Sdata_2_subtract_beta]).attr("class","line").attr("d",line4).style("stroke","#fd8d3c").style("stroke-width","0.5")};if(cline2_single_gamma){cline2_single_gamma.remove()};if(gamma_on==1){cline2_subtract_gamma=graph6.append("path").data([Sdata_2_subtract_gamma]).attr("class","line").attr("d",line4).style("stroke","#aec7e8").style("stroke-width","0.5")};if(cline2_single_limit){cline2_single_limit.remove()};if(limit_on==1){cline2_subtract_limit=graph7.append("path").data([Sdata_2_subtract_limit]).attr("class","line").attr("d",line4).style("stroke","white").style("stroke-width","0.5")}}};function Lyman_mode_change(){data_y_2=new Array(nbins_2);data_y_2_subtract=new Array(nbins_2);for(var i=0;i<data_y_2.length;i++){data_y_2[i]=1;if(alpha_on==1){data_y_2[i]=data_y_2[i]*data_y_2_alpha[i]};if(beta_on==1){data_y_2[i]=data_y_2[i]*data_y_2_beta[i]};if(gamma_on==1){data_y_2[i]=data_y_2[i]*data_y_2_gamma[i]};if(limit_on==1){data_y_2[i]=data_y_2[i]*data_y_2_limit[i]};data_y_2_subtract[i]=data_y_2_quasar[i]*data_y_2[i]};if(Sdata_2){Sdata_2=[]};if(Sdata_2_subtract){Sdata_2_subtract=[]};for(var i=0;i<data_y_2.length;i++){Sdata_2.push([data_x_2[i],data_y_2[i]])};for(var i=0;i<data_y_2_subtract.length;i++){Sdata_2_subtract.push([data_x_2[i],data_y_2_subtract[i]])};forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="line"){if(cline2_line){cline2_line.remove()};if(cline2_line_context){cline2_line_context.remove()};cline2_line=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2]).attr("class","line").attr("d",line2);cline2_line_context=context.append("path").data([Sdata_2]).attr("class","line").attr("d",line2b);if(stripping_on==0){draw_delimiter(1)}};if(forest_mode=="quasar"){if(cline2_subtract){cline2_subtract.remove()};if(cline2_subtract_context){cline2_subtract_context.remove()};cline2_subtract=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_subtract]).attr("class","line").attr("d",line2);cline2_subtract_context=context.append("path").data([Sdata_2_subtract]).attr("class","line").attr("d",line2b);if(quasar_on==1){if(cline2_quasar){cline2_quasar.remove()};cline2_quasar=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_quasar]).attr("class","line").attr("d",line2).style("stroke","red").style("stroke-dasharray",("3, 3")).style("stroke-width","2")};if(stripping_on==0){draw_delimiter(1)}}};function various_mode_check_alpha(){forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="quasar"){if(alpha_on==1){if(cline2_subtract_alpha){cline2_subtract_alpha.remove()};alpha_on=0}else{cline2_subtract_alpha=graph4.append("path").data([Sdata_2_subtract_alpha]).attr("class","line").attr("d",line4).style("stroke","#b5cf6b").style("stroke-width","0.5");alpha_on=1}};if(forest_mode=="line"){if(alpha_on==1){if(cline2_single_alpha){cline2_single_alpha.remove()};alpha_on=0}else{cline2_single_alpha=graph4.append("path").data([Sdata_2_alpha]).attr("class","line").attr("d",line4).style("stroke","#b5cf6b").style("stroke-width","0.5");alpha_on=1}};Lyman_mode_change()};function various_mode_check_beta(){forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="quasar"){if(beta_on==1){if(cline2_subtract_beta){cline2_subtract_beta.remove()};beta_on=0}else{cline2_subtract_beta=graph5.append("path").data([Sdata_2_subtract_beta]).attr("class","line").attr("d",line4).style("stroke","#fd8d3c").style("stroke-width","0.5");beta_on=1}};if(forest_mode=="line"){if(beta_on==1){if(cline2_single_beta){cline2_single_beta.remove()};beta_on=0}else{cline2_single_beta=graph5.append("path").data([Sdata_2_beta]).attr("class","line").attr("d",line4).style("stroke","#fd8d3c").style("stroke-width","0.5");beta_on=1}};Lyman_mode_change()};function various_mode_check_gamma(){forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="quasar"){if(gamma_on==1){if(cline2_subtract_gamma){cline2_subtract_gamma.remove()};gamma_on=0}else{cline2_subtract_gamma=graph6.append("path").data([Sdata_2_subtract_gamma]).attr("class","line").attr("d",line4).style("stroke","#aec7e8").style("stroke-width","0.5");gamma_on=1}};if(forest_mode=="line"){if(gamma_on==1){if(cline2_single_gamma){cline2_single_gamma.remove()};gamma_on=0}else{cline2_single_gamma=graph6.append("path").data([Sdata_2_gamma]).attr("class","line").attr("d",line4).style("stroke","#aec7e8").style("stroke-width","0.5");gamma_on=1}};Lyman_mode_change()};function various_mode_check_limit(){forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="quasar"){if(limit_on==1){if(cline2_subtract_limit){cline2_subtract_limit.remove()};limit_on=0}else{cline2_subtract_limit=graph7.append("path").data([Sdata_2_subtract_limit]).attr("class","line").attr("d",line4).style("stroke","white").style("stroke-width","0.5");limit_on=1}};if(forest_mode=="line"){if(limit_on==1){if(cline2_single_limit){cline2_single_limit.remove()};limit_on=0}else{cline2_single_limit=graph7.append("path").data([Sdata_2_limit]).attr("class","line").attr("d",line4).style("stroke","white").style("stroke-width","0.5");limit_on=1}};Lyman_mode_change()};function stripping(){if(focus.selectAll("path")){focus.selectAll("path").remove()};if(focus.selectAll("text")){focus.selectAll("text").remove()};if(focus.selectAll("g")){focus.selectAll("g").remove()};forest_mode=$('input[name=forest_mode]:checked').val();if(stripping_on==0){if(document.getElementById("quasar_check").checked==true){document.getElementById("quasar_check").checked=false;quasar_on=0.};if(forest_mode=="quasar"){cline2_subtract=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_subtract]).attr("class","line").attr("d",line2)};if(forest_mode=="line"){cline2_line=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2]).attr("class","line").attr("d",line2)};title2=focus.append("text").attr("class","title").attr("dy","-0.80em").attr("dx","25.0em").text("Lyman Alpha Forest");stripping_on=1}else{if(forest_mode=="quasar"){cline2_subtract=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_subtract]).attr("class","line").attr("d",line2)};if(forest_mode=="line"){cline2_line=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2]).attr("class","line").attr("d",line2)};if((forest_mode=="quasar")&&(quasar_on==1)){cline2_quasar=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_quasar]).attr("class","line").attr("d",line2).style("stroke","red").style("stroke-dasharray",("3, 3")).style("stroke-width","2")};draw_delimiter(1);replot_axis("2s");stripping_on=0}};function begin_animate(){$('.animate_off').hide();$('.animate_on').show();if(document.getElementById("alpha_mode").checked==false){various_mode_check_alpha();document.getElementById("alpha_mode").checked=true};if(document.getElementById("beta_mode").checked==false){various_mode_check_beta();document.getElementById("beta_mode").checked=true};if(document.getElementById("gamma_mode").checked==false){various_mode_check_gamma();document.getElementById("gamma_mode").checked=true};if(document.getElementById("limit_mode").checked==false){various_mode_check_limit();document.getElementById("limit_mode").checked=true};if(document.getElementById("quasar_check").checked==false){document.getElementById("quasar_check").checked=true;quasar_on=1.};if(document.getElementById("strip_mode").checked==true){document.getElementById("strip_mode").checked=false;stripping()};forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="line"){$("#forest_mode_quasar").prop("checked",true);forest_mode_change();animate_original=1.};if(focus.selectAll("path")){focus.selectAll("path").remove()};if(focus.selectAll("text")){focus.selectAll("text").remove()};if(focus.selectAll("g")){focus.selectAll("g").remove()};if(context.selectAll("path")){context.selectAll("path").remove()};if(context.selectAll("text")){context.selectAll("text").remove()};if(context.selectAll("g")){context.selectAll("g").remove()};focus.append("g").attr("class","x axis").attr("font-size","18px").attr("transform","translate(0,"+h2+")").call(xAxis2).append("text").attr("y",50.).attr("x",250.).attr("font-size","18px").text("Wavelength (Angstrom)");focus.append("g").attr("class","y axis").attr("font-size","18px").attr("transform","translate(0,0)").call(yAxis2).append("text").attr("y",-20.).attr("x",-40.).attr("font-size","18px").text("Flux");title2=focus.append("text").attr("class","title").attr("dy","-0.80em").attr("dx","25.0em").text("Lyman Alpha Forest");min_lambda_2_min=550.;min_lambda_2_obs=800.;max_lambda_2_obs=1540.;min_min_index=0.;min_obs_index=0.;max_obs_index=0.;alpha_index=0.;beta_index=0.;gamma_index=0.;clos_min_min=null;clos_min_obs=null;clos_max_obs=null;clos_alpha=null;clos_beta=null;clos_gamma=null;for(var j=0;j<data_x_2.length;j++){if(clos_min_min==null||Math.abs(data_x_2[j]/(1+z_quasar)-min_lambda_2_min)<Math.abs(clos_min_min-min_lambda_2_min)){clos_min_min=data_x_2[j]/(1+z_quasar);min_min_index=j};if(clos_min_obs==null||Math.abs(data_x_2[j]/(1+z_quasar)-min_lambda_2_obs)<Math.abs(clos_min_obs-min_lambda_2_obs)){clos_min_obs=data_x_2[j]/(1+z_quasar);min_obs_index=j};if(clos_max_obs==null||Math.abs(data_x_2[j]/(1+z_quasar)-max_lambda_2_obs)<Math.abs(clos_max_obs-max_lambda_2_obs)){clos_max_obs=data_x_2[j]/(1+z_quasar);max_obs_index=j};if(clos_alpha==null||Math.abs(data_x_2[j]/(1+z_quasar)-lambda_centre_2_rest)<Math.abs(clos_alpha-lambda_centre_2_rest)){clos_alpha=data_x_2[j]/(1+z_quasar);alpha_index=j};if(clos_beta==null||Math.abs(data_x_2[j]/(1+z_quasar)-lambda_centre_2_beta_rest)<Math.abs(clos_beta-lambda_centre_2_beta_rest)){clos_beta=data_x_2[j]/(1+z_quasar);beta_index=j};if(clos_gamma==null||Math.abs(data_x_2[j]/(1+z_quasar)-lambda_centre_2_gamma_rest)<Math.abs(clos_gamma-lambda_centre_2_gamma_rest)){clos_gamma=data_x_2[j]/(1+z_quasar);gamma_index=j}};diff_lambda=min_obs_index-min_min_index;rescale_axis("2x");draw_delimiter(2);Sdata_2_ani=[];n_obscure=max_obs_index-min_min_index;data_x_2_ani=new Array(n_obscure);data_y_2_ani_limit=new Array(n_obscure);data_y_2_ani_quasar=new Array(n_obscure);data_y_2_ani_alpha=new Array(n_obscure);data_y_2_ani_beta=new Array(n_obscure);data_y_2_ani_gamma=new Array(n_obscure);for(var i=0;i<n_obscure;i++){data_x_2_ani[i]=data_x_2[i+min_min_index]/(1+z_quasar);data_y_2_ani_alpha[i]=data_y_2_alpha[i+min_min_index];data_y_2_ani_beta[i]=data_y_2_beta[i+min_min_index];data_y_2_ani_gamma[i]=data_y_2_gamma[i+min_min_index];data_y_2_ani_limit[i]=data_y_2_subtract_limit[i+min_min_index]};for(var i=diff_lambda;i<data_y_2_ani_limit.length;i++){Sdata_2_ani.push([data_x_2_ani[i],data_y_2_ani_limit[i]])};cline2_ani=focus.append("g").append("path").data([Sdata_2_ani]).attr("class","line").attr("d",line2);counter=0.;update_alpha=alpha_index-min_obs_index;update_beta=beta_index-min_obs_index;update_gamma=gamma_index-min_obs_index;run_animate=setInterval(function(){if(counter>diff_lambda){stop_animate()};for(var i=Sdata_2_ani.length-1;i>0;i--){Sdata_2_ani[i][1]=Sdata_2_ani[i-1][1]};Sdata_2_ani[0][1]=data_y_2_ani_limit[diff_lambda-counter];Sdata_2_ani[update_alpha][1]=Sdata_2_ani[update_alpha][1]*data_y_2_ani_alpha[update_alpha+diff_lambda-counter];Sdata_2_ani[update_beta][1]=Sdata_2_ani[update_beta][1]*data_y_2_ani_beta[update_beta+diff_lambda-counter];Sdata_2_ani[update_gamma][1]=Sdata_2_ani[update_gamma][1]*data_y_2_ani_gamma[update_gamma+diff_lambda-counter];counter=counter+1;cline2_ani.data([Sdata_2_ani]).attr("class","line").attr("d",line2)},200)};function stop_animate(){$('.animate_off').show();$('.animate_on').hide();clearInterval(run_animate);if(Sdata_2_ani){Sdata_2_ani=[]};if(focus.selectAll("path")){focus.selectAll("path").remove()};if(focus.selectAll("text")){focus.selectAll("text").remove()};if(focus.selectAll("g")){focus.selectAll("g").remove()};quasar_wavelength=new Array(quasar_rest_wavelength.length);for(var i=0;i<quasar_rest_wavelength.length;i++){quasar_wavelength[i]=quasar_rest_wavelength[i]*(1+z_quasar)};min_lambda_2_obs=quasar_wavelength[0];max_lambda_2_obs=quasar_wavelength[quasar_wavelength.length-1];replot_axis(2);rescale_axis("2x");rescale_axis("4x");setTimeout(function(){brushed()},800);if(animate_original==1.){$("#forest_mode_line").prop("checked",true);forest_mode_change();animate_original=0.};if(cline2_line){cline2_line.remove()};if(cline2_line_context){cline2_line_context.remove()};if(cline2_subtract){cline2_subtract.remove()}if(cline2_subtract_context){cline2_subtract_context.remove()}if(cline2_quasar){cline2_quasar.remove()};forest_mode=$('input[name=forest_mode]:checked').val();if(forest_mode=="line"){cline2_line=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2]).attr("class","line").attr("d",line2);cline2_line_context=context.append("path").data([Sdata_2]).attr("class","line").attr("d",line2b)};if(forest_mode=="quasar"){cline2_subtract=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_subtract]).attr("class","line").attr("d",line2);cline2_subtract_context=context.append("path").data([Sdata_2_subtract]).attr("class","line").attr("d",line2b);if(quasar_on==1){cline2_quasar=focus.append("path").attr("clip-path","url(#clip)").data([Sdata_2_quasar]).attr("class","line").attr("d",line2).style("stroke","red").style("stroke-dasharray",("3, 3")).style("stroke-width","2")}};if(stripping_on==0){draw_delimiter(1)}};